
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="0X10CC">
      
      
        <link rel="canonical" href="https://tang-jiapeng.github.io/core/csapp/ch8/">
      
      
        <link rel="prev" href="../ch7/">
      
      
        <link rel="next" href="../ch9/">
      
      
      <link rel="icon" href="../../../logo.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Chapter8ï¼šå¼‚å¸¸æ§åˆ¶æµ - 0X10CC's notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/link.css">
    
      <link rel="stylesheet" href="../../../stylesheets/customize.css">
    
      <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
    <link rel="stylesheet" href="../../../assets/stylesheets/custom.00c04c01.min.css">
  
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          è·³è½¬è‡³
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="ä¸å†æ˜¾ç¤ºæ­¤æ¶ˆæ¯">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
     Follow <strong>@Wcowin</strong> on
    <a rel="me" href="https://space.bilibili.com/1407028951?spm_id_from=333.1007.0.0">
      <span class="twemoji bilibili">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92.02c-26.45-.8-48.21-9.8-65.28-27.2C9.682 419.4.767 396.5 0 368.2V169.8c.767-26 9.682-47.6 26.74-65.7C43.81 87.75 65.57 78.77 92.02 78h29.38L96.05 52.19c-5.75-5.73-8.63-13-8.63-21.79 0-8.8 2.88-16.06 8.63-21.797C101.8 2.868 109.1 0 117.9 0q13.2 0 21.9 8.603L213.1 78h88l74.5-69.397C381.7 2.868 389.2 0 398 0q13.2 0 21.9 8.603c5.7 5.737 8.6 12.997 8.6 21.797 0 8.79-2.9 16.06-8.6 21.79L394.6 78h29.3c26.4.77 48 9.75 64.7 26.1m-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96.05c-9.59.4-17.45 3.7-23.58 9.8-6.14 6.1-9.4 13.9-9.78 23.5v194.4c0 9.2 3.26 17 9.78 23.5s14.38 9.8 23.58 9.8H416.4c9.2 0 17-3.3 23.3-9.8s9.7-14.3 10.1-23.5zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5s-17.5-3.2-23.6-9.5-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2s13.2-9.6 23.3-10c9.2.4 17 3.7 23.3 10m191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2s-14 9.5-23.6 9.5-17.4-3.2-23.6-9.5c-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2s14.1-9.6 23.3-10c9.2.4 17 3.7 23.3 10"/></svg>
      </span>
      <strong>Bilibili</strong>
    </a>
    and
    <a href="https://twitter.com/Wcowin_">
      <span class="twemoji twitter">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
      </span>
      <strong>Twitter</strong>
    </a>
  
          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
    <a href="../../.." title="0X10CC&#39;s notes" class="md-header__button md-logo" aria-label="0X10CC's notes" data-md-component="logo">
      
  <img src="../../../assets/logo.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            0X10CC's notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter8ï¼šå¼‚å¸¸æ§åˆ¶æµ
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="å…³é—­è‡ªåŠ¨æ¨¡å¼"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="å…³é—­è‡ªåŠ¨æ¨¡å¼" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="blue"  aria-label="åˆ‡æ¢è‡³å¤œé—´æ¨¡å¼"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="åˆ‡æ¢è‡³å¤œé—´æ¨¡å¼" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="åˆ‡æ¢è‡³æ—¥é—´æ¨¡å¼"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="åˆ‡æ¢è‡³æ—¥é—´æ¨¡å¼" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="æŸ¥æ‰¾">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="åˆ†äº«" aria-label="åˆ†äº«" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="æ¸…ç©ºå½“å‰å†…å®¹" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/tang-jiapeng/tang-jiapeng.github.io" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    tang-jiapeng.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="æ ‡ç­¾" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  ğŸ¡ä¸»é¡µ

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../langs/" class="md-tabs__link">
          
  
    
  
  ç¼–ç¨‹è¯­è¨€

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  è®¡ç®—æœºåŸºç¡€

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../distributed/" class="md-tabs__link">
          
  
    
  
  åˆ†å¸ƒå¼ç³»ç»Ÿ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../develop/" class="md-tabs__link">
          
  
    
  
  åç«¯å¼€å‘

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../tools/" class="md-tabs__link">
          
  
    
  
  å·¥å…·

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="å¯¼èˆªæ " data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="0X10CC&#39;s notes" class="md-nav__button md-logo" aria-label="0X10CC's notes" data-md-component="logo">
      
  <img src="../../../assets/logo.ico" alt="logo">

    </a>
    0X10CC's notes
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tang-jiapeng/tang-jiapeng.github.io" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    tang-jiapeng.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ¡ä¸»é¡µ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../langs/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ç¼–ç¨‹è¯­è¨€
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            ç¼–ç¨‹è¯­è¨€
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    C++é›¶ç¢æ‚è®°
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            C++é›¶ç¢æ‚è®°
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langs/cpp/%E9%9B%B6%E7%A2%8E%E6%9D%82%E8%AE%B0/%E9%A1%B6%E5%B1%82const%E4%B8%8E%E5%BA%95%E5%B1%82const/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é¡¶å±‚constä¸åº•å±‚const
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langs/cpp/%E9%9B%B6%E7%A2%8E%E6%9D%82%E8%AE%B0/%E5%80%BC%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å€¼ç±»å‹ä¸å³å€¼å¼•ç”¨
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langs/cpp/%E9%9B%B6%E7%A2%8E%E6%9D%82%E8%AE%B0/%E6%95%B0%E7%BB%84%E6%8C%87%E9%92%88%E4%B8%8E%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ•°ç»„æŒ‡é’ˆä¸å‡½æ•°æŒ‡é’ˆ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langs/cpp/%E9%9B%B6%E7%A2%8E%E6%9D%82%E8%AE%B0/C%2B%2B%E7%B1%BB%E5%AF%B9%E8%B1%A1%E5%B8%83%E5%B1%80/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C++ç±»å¯¹è±¡å¸ƒå±€
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langs/cpp/%E9%9B%B6%E7%A2%8E%E6%9D%82%E8%AE%B0/C%2B%2B%E4%B8%AD%E7%9A%84%E5%A4%9A%E6%80%81%E4%B8%8ERTTI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C++ä¸­çš„å¤šæ€ä¸RTTI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Effective Modern C++
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Effective Modern C++
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langs/cpp/effective/item1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    item1ï¼šç†è§£æ¨¡æ¿ç±»å‹æ¨å¯¼
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langs/cpp/effective/item2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    item2ï¼šç†è§£autoç±»å‹æ¨å¯¼
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langs/cpp/effective/item3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    item3ï¼šç†è§£decltype
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langs/cpp/effective/item7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    item7ï¼šåŒºåˆ«ä½¿ç”¨()å’Œ{}åˆ›å»ºå¯¹è±¡
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langs/cpp/effective/item9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    item9ï¼šä¼˜å…ˆè€ƒè™‘åˆ«åå£°æ˜è€Œétypedef
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langs/cpp/effective/item23/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    item23ï¼šç†è§£std::moveå’Œstd::forward
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    è®¡ç®—æœºåŸºç¡€
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            è®¡ç®—æœºåŸºç¡€
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    CMU15-213ï¼šCSAPP
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            CMU15-213ï¼šCSAPP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter1ï¼šè®¡ç®—æœºç³»ç»Ÿæ¼«æ¸¸
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter2ï¼šä¿¡æ¯çš„è¡¨ç¤ºå’Œå¤„ç†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter3ï¼šç¨‹åºçš„æœºå™¨çº§è¡¨ç¤º
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter4ï¼šå¤„ç†å™¨ä½“ç³»ç»“æ„
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter5ï¼šä¼˜åŒ–ç¨‹åºæ€§èƒ½
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter6ï¼šå­˜å‚¨å™¨å±‚æ¬¡ç»“æ„
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter7ï¼šé“¾æ¥
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Chapter8ï¼šå¼‚å¸¸æ§åˆ¶æµ
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Chapter8ï¼šå¼‚å¸¸æ§åˆ¶æµ
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      å¼‚å¸¸
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å¼‚å¸¸">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      å¼‚å¸¸å¤„ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      å¼‚å¸¸çš„åˆ†ç±»
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å¼‚å¸¸çš„åˆ†ç±»">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸­æ–­
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      é™·é˜±å’Œç³»ç»Ÿè°ƒç”¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      æ•…éšœ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸­æ­¢
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linuxx86-64" class="md-nav__link">
    <span class="md-ellipsis">
      Linux/x86-64 ç³»ç»Ÿä¸­çš„å¼‚å¸¸
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linux/x86-64 ç³»ç»Ÿä¸­çš„å¼‚å¸¸">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      æ•…éšœå’Œä¸­æ­¢
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      ç³»ç»Ÿè°ƒç”¨
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›ç¨‹
    </span>
  </a>
  
    <nav class="md-nav" aria-label="è¿›ç¨‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      é€»è¾‘æ§åˆ¶æµ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      å¹¶å‘æµ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      ç§æœ‰åœ°å€ç©ºé—´
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      ç”¨æˆ·æ€å’Œå†…æ ¸æ€
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸Šä¸‹æ–‡åˆ‡æ¢
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      ç³»ç»Ÿè°ƒç”¨é”™è¯¯å¤„ç†
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›ç¨‹æ§åˆ¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="è¿›ç¨‹æ§åˆ¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id" class="md-nav__link">
    <span class="md-ellipsis">
      è·å–è¿›ç¨‹ ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      åˆ›å»ºå’Œç»ˆæ­¢è¿›ç¨‹
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      å›æ”¶å­è¿›ç¨‹
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      è®©è¿›ç¨‹ä¼‘çœ 
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      åŠ è½½å¹¶è¿è¡Œç¨‹åº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fork-execve" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨ fork å’Œ execve è¿è¡Œç¨‹åº
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      ä¿¡å·
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ä¿¡å·">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      ä¿¡å·æœ¯è¯­
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      å‘é€ä¿¡å·
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å‘é€ä¿¡å·">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›ç¨‹ç»„
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      ä»é”®ç›˜å‘é€ä¿¡å·
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kill" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨ kill å‡½æ•°å‘é€ä¿¡å·
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alarm" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨ alarm å‡½æ•°å‘é€ä¿¡å·
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      æ¥æ”¶ä¿¡å·
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      é˜»å¡ä¿¡å·
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      ç¼–å†™ä¿¡å·å¤„ç†ç¨‹åº
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¼–å†™ä¿¡å·å¤„ç†ç¨‹åº">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      å®‰å…¨çš„ä¿¡å·å¤„ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      æ­£ç¡®çš„ä¿¡å·å¤„ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      å¯ç§»æ¤çš„ä¿¡å·å¤„ç†
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      é¿å…å¹¶å‘é”™è¯¯
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      æ˜¾å¼ç­‰å¾…ä¿¡å·
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      éæœ¬åœ°è·³è½¬
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter9ï¼šè™šæ‹Ÿå†…å­˜
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter10ï¼šç³»ç»Ÿçº§I/O
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter11ï¼šç½‘ç»œç¼–ç¨‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter12ï¼šå¹¶å‘ç¼–ç¨‹
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../distributed/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    åˆ†å¸ƒå¼ç³»ç»Ÿ
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            åˆ†å¸ƒå¼ç³»ç»Ÿ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../develop/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    åç«¯å¼€å‘
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            åç«¯å¼€å‘
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../tools/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    å·¥å…·
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            å·¥å…·
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      å¼‚å¸¸
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å¼‚å¸¸">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      å¼‚å¸¸å¤„ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      å¼‚å¸¸çš„åˆ†ç±»
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å¼‚å¸¸çš„åˆ†ç±»">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸­æ–­
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      é™·é˜±å’Œç³»ç»Ÿè°ƒç”¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      æ•…éšœ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸­æ­¢
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linuxx86-64" class="md-nav__link">
    <span class="md-ellipsis">
      Linux/x86-64 ç³»ç»Ÿä¸­çš„å¼‚å¸¸
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linux/x86-64 ç³»ç»Ÿä¸­çš„å¼‚å¸¸">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      æ•…éšœå’Œä¸­æ­¢
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      ç³»ç»Ÿè°ƒç”¨
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›ç¨‹
    </span>
  </a>
  
    <nav class="md-nav" aria-label="è¿›ç¨‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      é€»è¾‘æ§åˆ¶æµ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      å¹¶å‘æµ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      ç§æœ‰åœ°å€ç©ºé—´
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      ç”¨æˆ·æ€å’Œå†…æ ¸æ€
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸Šä¸‹æ–‡åˆ‡æ¢
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      ç³»ç»Ÿè°ƒç”¨é”™è¯¯å¤„ç†
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›ç¨‹æ§åˆ¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="è¿›ç¨‹æ§åˆ¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id" class="md-nav__link">
    <span class="md-ellipsis">
      è·å–è¿›ç¨‹ ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      åˆ›å»ºå’Œç»ˆæ­¢è¿›ç¨‹
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      å›æ”¶å­è¿›ç¨‹
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      è®©è¿›ç¨‹ä¼‘çœ 
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      åŠ è½½å¹¶è¿è¡Œç¨‹åº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fork-execve" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨ fork å’Œ execve è¿è¡Œç¨‹åº
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      ä¿¡å·
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ä¿¡å·">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      ä¿¡å·æœ¯è¯­
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      å‘é€ä¿¡å·
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å‘é€ä¿¡å·">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›ç¨‹ç»„
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      ä»é”®ç›˜å‘é€ä¿¡å·
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kill" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨ kill å‡½æ•°å‘é€ä¿¡å·
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alarm" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨ alarm å‡½æ•°å‘é€ä¿¡å·
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      æ¥æ”¶ä¿¡å·
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      é˜»å¡ä¿¡å·
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      ç¼–å†™ä¿¡å·å¤„ç†ç¨‹åº
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¼–å†™ä¿¡å·å¤„ç†ç¨‹åº">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      å®‰å…¨çš„ä¿¡å·å¤„ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      æ­£ç¡®çš„ä¿¡å·å¤„ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      å¯ç§»æ¤çš„ä¿¡å·å¤„ç†
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      é¿å…å¹¶å‘é”™è¯¯
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      æ˜¾å¼ç­‰å¾…ä¿¡å·
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      éæœ¬åœ°è·³è½¬
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/tang-jiapeng/tang-jiapeng.github.io/edit/main/docs/core/csapp/ch8.md" title="ç¼–è¾‘æ­¤é¡µ" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/tang-jiapeng/tang-jiapeng.github.io/raw/main/docs/core/csapp/ch8.md" title="æŸ¥çœ‹æœ¬é¡µçš„æºä»£ç " class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="_1">å¼‚å¸¸æ§åˆ¶æµ<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>åœ¨è®¡ç®—æœºçš„è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œç¨‹åºè®¡æ•°å™¨ä¾æ¬¡æŒ‡å‘ä¸€ç³»åˆ—çš„å€¼ï¼š<span class="arithmatex">\(a_0, a_1, ..., a_n\)</span>ã€‚å…¶ä¸­ï¼Œ<span class="arithmatex">\(a_k\)</span> æ˜¯å…¶å¯¹åº”æŒ‡ä»¤ <span class="arithmatex">\(I_k\)</span> çš„åœ°å€ã€‚ä» <span class="arithmatex">\(a_k\)</span> åˆ° <span class="arithmatex">\(a_{k+1}\)</span> çš„è½¬æ¢è¢«ç§°ä¸ºæ§åˆ¶è½¬ç§»ï¼ˆControl Transferï¼‰ï¼Œä¸€ç³»åˆ—çš„æ§åˆ¶è½¬ç§»åˆ™è¢«ç§°ä¸ºå¤„ç†å™¨çš„æ§åˆ¶æµï¼ˆControl Flowï¼‰ã€‚</p>
<p>æœ€ç®€å•çš„æ§åˆ¶æµä¾¿æ˜¯ç¨‹åºä¸­çš„æŒ‡ä»¤æŒ‰é¡ºåºæ‰§è¡Œï¼Œå³ <span class="arithmatex">\(I_k\)</span> ä¸ <span class="arithmatex">\(I_{k+1}\)</span> åœ¨å†…å­˜ä¸­ç›¸é‚»ã€‚ä¸è¿‡ï¼Œè¿™ç§â€œå¹³æ»‘â€çš„æ§åˆ¶æµé€šå¸¸å› æŒ‡ä»¤çš„è·³è½¬ã€è°ƒç”¨å’Œè¿”å›è€Œçªç„¶æ”¹å˜ï¼Œæ­¤æ—¶ <span class="arithmatex">\(I_k\)</span> ä¾¿ä¸å†ä¸ <span class="arithmatex">\(I_{k+1}\)</span> ç›¸é‚»ã€‚</p>
<p>ç¨‹åºå†…éƒ¨çš„çŠ¶æ€æ˜¯ç”±ç¨‹åºå˜é‡è¡¨ç¤ºçš„ï¼Œæ§åˆ¶æµä½¿å¾—ç¨‹åºå¯ä»¥å¯¹å…¶æ›´æ–°åšå‡ºååº”ã€‚ä½†ç³»ç»Ÿè¿˜å¿…é¡»èƒ½å¤Ÿåº”å¯¹è‡ªèº«çŠ¶æ€çš„å˜åŒ–ï¼Œå®ƒä»¬æ— æ³•è¢«å†…éƒ¨ç¨‹åºå˜é‡æ•è·ï¼Œç”šè‡³ä¸ä¸€å®šä¸ç¨‹åºçš„æ‰§è¡Œæœ‰å…³ã€‚æ¯”å¦‚ï¼Œæ•°æ®åŒ…åœ¨åˆ°è¾¾ç½‘ç»œé€‚é…å™¨åéœ€è¦è¢«å­˜å‚¨åˆ°å†…å­˜ä¸­ï¼›ç¨‹åºè¯·æ±‚ç£ç›˜ä¸­çš„æ•°æ®æ—¶éœ€è¦å¾—çŸ¥å…¶ä½•æ—¶å¯ç”¨ï¼›çˆ¶è¿›ç¨‹å¿…é¡»åœ¨å…¶å­è¿›ç¨‹ç»ˆæ­¢æ—¶æ”¶åˆ°é€šçŸ¥ç­‰ã€‚</p>
<p>ç°ä»£ç³»ç»Ÿé€šè¿‡å¼‚å¸¸æ§åˆ¶æµï¼ˆExceptional Control Flowï¼ŒECFï¼‰æ¥å¤„ç†ä¸Šè¿°æƒ…å†µï¼Œå®ƒåº”ç”¨äºè®¡ç®—æœºç³»ç»Ÿçš„æ‰€æœ‰çº§åˆ«ä¸­ã€‚</p>
<h2 id="_2">å¼‚å¸¸<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>å¼‚å¸¸ï¼ˆExceptionï¼‰æ˜¯ä¸ºäº†å“åº”å¤„ç†å™¨çŠ¶æ€æ”¹å˜è€Œåœ¨æ§åˆ¶æµä¸­çªç„¶å‘ç”Ÿçš„å˜åŒ–ï¼Œå…¶åŸºæœ¬æ€æƒ³å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img alt="alt text" src="../image/image-87.png" />
å¤„ç†å™¨çŠ¶æ€çš„å˜åŒ–è¢«ç§°ä¸ºäº‹ä»¶ï¼ˆEventï¼‰ï¼Œå®ƒå¯èƒ½ä¸å½“å‰æŒ‡ä»¤ï¼ˆ<span class="arithmatex">\(I_{curr}\)</span>ï¼‰çš„æ‰§è¡Œç›´æ¥ç›¸å…³ï¼Œæ¯”å¦‚ç®—æœ¯æº¢å‡ºæˆ–é™¤æ•°ä¸ºé›¶ï¼›ä¹Ÿå¯èƒ½ä¸å½“å‰æŒ‡ä»¤çš„æ‰§è¡Œæ— å…³ï¼Œæ¯”å¦‚ç³»ç»Ÿè®¡æ—¶å™¨å…³é—­æˆ– I/O è¯·æ±‚å®Œæˆã€‚</p>
<h3 id="_3">å¼‚å¸¸å¤„ç†<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>å¼‚å¸¸å¤„ç†æ¶‰åŠåˆ°è½¯ä»¶å’Œç¡¬ä»¶çš„å¯†åˆ‡åˆä½œï¼Œå› æ­¤å¾ˆå®¹æ˜“å°†ä¸åŒç»„ä»¶æ‰§è¡Œçš„å·¥ä½œç›¸æ··æ·†ã€‚ç³»ç»Ÿä¸­æ¯ç§å¯èƒ½çš„å¼‚å¸¸éƒ½å¯¹åº”äº†ä¸€ä¸ªå”¯ä¸€çš„éè´Ÿæ•´æ•°ï¼Œå³å¼‚å¸¸æ•°å­—ï¼ˆException Numberï¼‰ã€‚å½“è®¡ç®—æœºç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šåˆå§‹åŒ–ä¸€ä¸ªè·³è½¬è¡¨ï¼Œä¹Ÿç§°å¼‚å¸¸è¡¨ï¼ˆException Tableï¼‰ã€‚å¼‚å¸¸æ•°å­—æ˜¯å¼‚å¸¸è¡¨çš„ç´¢å¼•ï¼Œå…¶ä¸­çš„æ¯ä¸ªæ¡ç›® k å‡åŒ…å«äº†å¼‚å¸¸ k çš„å¤„ç†ç¨‹åºåœ°å€ï¼š</p>
<p><img alt="alt text" src="../image/image-88.png" />
å½“å¤„ç†å™¨æ£€æµ‹åˆ°äº‹ä»¶çš„å‘ç”Ÿæ—¶ï¼Œé¦–å…ˆå°†ç¡®å®šå¼‚å¸¸æ•°å­—ï¼Œç„¶åæ ¹æ®å¼‚å¸¸è¡¨è°ƒç”¨å¯¹åº”çš„å¼‚å¸¸å¤„ç†ç¨‹åºã€‚</p>
<p><img alt="alt text" src="../image/image-89.png" />
å¼‚å¸¸ä¸è¿‡ç¨‹è°ƒç”¨ç±»ä¼¼ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›é‡è¦åŒºåˆ«ï¼š</p>
<ul>
<li>å¼‚å¸¸çš„è¿”å›åœ°å€è¦ä¹ˆæ˜¯å½“å‰æŒ‡ä»¤ï¼ˆ<span class="arithmatex">\(I_{curr}\)</span>ï¼‰ï¼Œè¦ä¹ˆæ˜¯ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆ<span class="arithmatex">\(I_{next}\)</span>ï¼‰ï¼›</li>
<li>å¤„ç†å™¨è¿˜ä¼šå°†ä¸€äº›é¢å¤–çš„å¤„ç†å™¨çŠ¶æ€ä¿¡æ¯å‹å…¥æ ˆä¸­ã€‚å½“å¤„ç†ç¨‹åºè¿”å›åï¼Œè¿™äº›ä¿¡æ¯æ˜¯é‡å¯è¢«ä¸­æ–­ç¨‹åºæ‰€å¿…éœ€çš„ï¼›</li>
<li>å¼‚å¸¸å¤„ç†ç¨‹åºåœ¨å†…æ ¸æ€è¿è¡Œï¼Œå› æ­¤å¯ä»¥è®¿é—®æ‰€æœ‰ç³»ç»Ÿèµ„æºã€‚</li>
</ul>
<h3 id="_4">å¼‚å¸¸çš„åˆ†ç±»<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p><img alt="alt text" src="../image/image-90.png" /></p>
<h4 id="_5">ä¸­æ–­<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<p>ä¸­æ–­ï¼ˆInterruptï¼‰å¼‚æ­¥å‘ç”Ÿï¼Œå› ä¸ºå®ƒæ˜¯ç”±å¤„ç†å™¨å¤–éƒ¨çš„ I/O è®¾å¤‡å‘å‡ºçš„ä¿¡å·äº§ç”Ÿçš„ã€‚</p>
<p><img alt="alt text" src="../image/image-91.png" />
å½“å‰æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•åï¼Œå¤„ç†å™¨æ³¨æ„åˆ°ä¸­æ–­å¼•è„šå˜é«˜ï¼Œäºæ˜¯ä»ç³»ç»Ÿæ€»çº¿è¯»å–å¼‚å¸¸æ•°å­—ï¼Œç„¶åè°ƒç”¨å¯¹åº”çš„ä¸­æ–­å¤„ç†ç¨‹åºã€‚å½“å¤„ç†ç¨‹åºè¿”å›æ—¶ï¼Œå®ƒå°†æ§åˆ¶æƒè¿”å›ç»™ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚éšåç¨‹åºç»§ç»­æ‰§è¡Œï¼Œå°±å¥½åƒä¸­æ–­ä»æœªå‘ç”Ÿè¿‡ä¸€æ ·ã€‚</p>
<p>å…¶ä½™å‡ ç§å¼‚å¸¸ä½œä¸ºå½“å‰æŒ‡ä»¤çš„æ‰§è¡Œç»“æœåŒæ­¥å‘ç”Ÿï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ•…éšœæŒ‡ä»¤ï¼ˆFaulting Instructionï¼‰ã€‚</p>
<h4 id="_6">é™·é˜±å’Œç³»ç»Ÿè°ƒç”¨<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<p>ä¸ä¸­æ–­å¤„ç†ç¨‹åºä¸€æ ·ï¼Œé™·é˜±ï¼ˆTrapï¼‰å¤„ç†ç¨‹åºä¹Ÿå°†æ§åˆ¶è¿”å›ç»™ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚å…¶æœ€é‡è¦çš„ç”¨é€”æ˜¯åœ¨ç”¨æˆ·ç¨‹åºå’Œå†…æ ¸ä¹‹é—´æä¾›æ¥å£ï¼Œå³ç³»ç»Ÿè°ƒç”¨ï¼ˆSystem Callï¼‰ã€‚</p>
<p>ç”¨æˆ·ç¨‹åºé€šè¿‡ç³»ç»Ÿè°ƒç”¨å‘å†…æ ¸è¯·æ±‚æœåŠ¡ï¼Œå¦‚è¯»å–æ–‡ä»¶ï¼ˆ<code>read</code>ï¼‰ã€åˆ›å»ºæ–°è¿›ç¨‹ï¼ˆ<code>fork</code>ï¼‰ã€åŠ è½½æ–°ç¨‹åºï¼ˆ<code>execve</code>ï¼‰å’Œç»ˆæ­¢å½“å‰è¿›ç¨‹ï¼ˆ<code>exit</code>ï¼‰ç­‰ã€‚
<img alt="alt text" src="../image/image-92.png" />
åœ¨ç¨‹åºå‘˜çœ‹æ¥ï¼Œç³»ç»Ÿè°ƒç”¨å’Œå¸¸è§„å‡½æ•°æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ä½†å¸¸è§„å‡½æ•°è¿è¡Œåœ¨ç”¨æˆ·æ€ï¼Œå› æ­¤å…¶å¯æ‰§è¡Œçš„æŒ‡ä»¤ç±»å‹å—é™ï¼Œä¹Ÿåªèƒ½è®¿é—®ç”¨æˆ·æ ˆã€‚è€Œç³»ç»Ÿè°ƒç”¨è¿è¡Œåœ¨å†…æ ¸æ€ï¼Œèƒ½å¤Ÿæ‰§è¡Œç‰¹æƒæŒ‡ä»¤å¹¶è®¿é—®å†…æ ¸æ ˆã€‚</p>
<h4 id="_7">æ•…éšœ<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<p>æ•…éšœï¼ˆFaultingï¼‰æ˜¯ç”±ä¸€äº›é”™è¯¯çŠ¶å†µå¼•èµ·çš„å¼‚å¸¸ï¼Œè€Œè¿™äº›é”™è¯¯æƒ…å†µæœ‰å¯èƒ½è¢«å¤„ç†ç¨‹åºä¿®æ­£ï¼Œå¦åˆ™å°†è¿”å›åˆ°å†…æ ¸ä¸­çš„ä¸­æ­¢ä¾‹ç¨‹ï¼ˆå›¾ä¸­çš„â€œabortâ€ï¼‰ï¼š</p>
<p><img alt="alt text" src="../image/image-93.png" /></p>
<h4 id="_8">ä¸­æ­¢<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<p>ä¸æ•…éšœç›¸æ¯”ï¼Œå¼•å‘ä¸­æ­¢ï¼ˆAbortï¼‰çš„é”™è¯¯çŠ¶å†µæ— æ³•æŒ½æ•‘ã€‚é€šå¸¸æ˜¯ç¡¬ä»¶å‡ºç°é—®é¢˜ï¼Œå¦‚ RAM ä½æŸåå¼•èµ·çš„å¥‡å¶æ ¡éªŒé”™è¯¯ã€‚ä¸­æ­¢å¤„ç†ç¨‹åºæ°¸è¿œä¸ä¼šå°†æ§åˆ¶æƒè¿”å›ç»™åº”ç”¨ç¨‹åºï¼š</p>
<p><img alt="alt text" src="../image/image-94.png" /></p>
<h3 id="linuxx86-64">Linux/x86-64 ç³»ç»Ÿä¸­çš„å¼‚å¸¸<a class="headerlink" href="#linuxx86-64" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Exception Number</th>
<th>Description</th>
<th>Exception Class</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Divide Error</td>
<td>Fault</td>
</tr>
<tr>
<td>13</td>
<td>General Protection Fault</td>
<td>Fault</td>
</tr>
<tr>
<td>14</td>
<td>Page Fault</td>
<td>Fault</td>
</tr>
<tr>
<td>18</td>
<td>Machine Check</td>
<td>Abort</td>
</tr>
<tr>
<td>32-255</td>
<td>OS-defined Exception</td>
<td>Interrupt or Trap</td>
</tr>
</tbody>
</table>
<h4 id="_9">æ•…éšœå’Œä¸­æ­¢<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<ul>
<li>é™¤æ³•æ•…éšœï¼ˆDivide Errorï¼‰ï¼šå½“åº”ç”¨ç¨‹åºå°è¯•é™¤ä»¥ 0 æˆ–é™¤æ³•æŒ‡ä»¤çš„ç»“æœå¯¹ç›®æ ‡æ“ä½œæ•°æ¥è¯´å¤ªå¤§æ—¶ï¼Œå°±ä¼šå‘ç”Ÿé™¤æ³•æ•…éšœã€‚Unix ä¸ä¼šè¯•å›¾çº æ­£é™¤æ³•æ•…éšœï¼Œè€Œæ˜¯ç›´æ¥ä¸­æ­¢ç¨‹åºï¼›</li>
<li>ä¸€èˆ¬ä¿æŠ¤æ•…éšœï¼ˆGeneral Protection Faultï¼‰ï¼šä¸€èˆ¬ä¿æŠ¤æ•…éšœå‡ºç°çš„åŸå› æœ‰å¾ˆå¤šï¼Œé€šå¸¸æ˜¯ç¨‹åºå¼•ç”¨äº†æœªå®šä¹‰çš„è™šæ‹Ÿå†…å­˜åŒºåŸŸï¼Œæˆ–è¯•å›¾å‘åªè¯»æ–‡æœ¬æ®µå†™å…¥ã€‚Linux ä¸ä¼šè¯•å›¾çº æ­£è¯¥æ•…éšœï¼Œè€Œ Shell ä¸€èˆ¬å°†å…¶æŠ¥å‘Šä¸ºåˆ†æ®µæ•…éšœï¼ˆSegmentation Faultsï¼‰ï¼›</li>
<li>ç¼ºé¡µæ•…éšœï¼ˆPage Faultï¼‰ï¼šç¨‹åºå¼•ç”¨ä¸åœ¨å†…å­˜è€Œåœ¨ç£ç›˜ä¸Šçš„è™šæ‹Ÿé¡µé¢ä¼šå¯¼è‡´ç¼ºé¡µæ•…éšœã€‚å¤„ç†ç¨‹åºå°†ç£ç›˜ä¸Šåˆé€‚çš„è™šæ‹Ÿå†…å­˜é¡µé¢æ˜ å°„åˆ°ç‰©ç†å†…å­˜é¡µé¢ï¼Œç„¶åé‡æ–°æ‰§è¡Œæ•…éšœæŒ‡ä»¤ï¼›</li>
<li>æœºå™¨æ£€æŸ¥ï¼ˆMachine Checkï¼‰ï¼šä¸€æ—¦ç³»ç»Ÿåœ¨æ‰§è¡ŒæŒ‡ä»¤æœŸé—´æ£€æµ‹åˆ°è‡´å‘½çš„ç¡¬ä»¶é”™è¯¯ï¼Œä¾¿ä¼šå‘ç”Ÿæœºå™¨æ£€æŸ¥ã€‚å¤„ç†ç¨‹åºæ°¸è¿œä¸ä¼šå°†æ§åˆ¶æƒè¿”å›ç»™åº”ç”¨ç¨‹åºã€‚</li>
</ul>
<h4 id="_10">ç³»ç»Ÿè°ƒç”¨<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<p><img alt="alt text" src="../image/image-95.png" />
ä¸Šå›¾ä¸­çš„æ¯ä¸ªç³»ç»Ÿè°ƒç”¨éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ•°å­—ï¼Œå¯¹åº”äº†å†…æ ¸ä¸­è·³è½¬è¡¨çš„åç§»é‡ã€‚æ³¨æ„ï¼Œè¯¥è·³è½¬è¡¨ä¸ä¸Šæ–‡æåˆ°çš„å¼‚å¸¸è¡¨ä¸åŒã€‚</p>
<p>C æ ‡å‡†åº“ä¸ºå¤§å¤šæ•°ç³»ç»Ÿè°ƒç”¨æä¾›äº†ä¸€ç»„åŒ…è£…å‡½æ•°ï¼ˆWrapper Functionï¼‰ï¼Œå®ƒä»¬æ¯”ç›´æ¥ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨æ›´åŠ æ–¹ä¾¿ã€‚ç³»ç»Ÿè°ƒç”¨åŠå…¶ç›¸å…³çš„åŒ…è£…å‡½æ•°è¢«ç»Ÿç§°ä¸ºç³»ç»Ÿçº§å‡½æ•°ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç³»ç»Ÿçº§å‡½æ•°<code>write</code>ä»£æ›¿<code>printf</code>ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello, world</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="p">);</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">    </span><span class="n">_exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>X86-64 ç³»ç»Ÿé€šè¿‡<code>syscall</code>æŒ‡ä»¤ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ï¼Œå…¶æ‰€æœ‰å‚æ•°å‡é€šè¿‡å¯„å­˜å™¨ä¼ é€’ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œå¯„å­˜å™¨ %rax ä¿å­˜ç³»ç»Ÿè°ƒç”¨ç¼–å·ï¼Œå¯„å­˜å™¨ %rdiã€%rsiã€%rdxã€%r10ã€%r8 å’Œ %r9 ä¾æ¬¡ä¿å­˜å„å‚æ•°çš„å€¼ã€‚ç³»ç»Ÿè°ƒç”¨çš„è¿”å›å€¼å°†å†™å…¥åˆ°å¯„å­˜å™¨ %rax ä¸­ï¼Œè‹¥ä¸ºè´Ÿåˆ™è¡¨ç¤ºå‘ç”Ÿäº†ä¸è´Ÿ<code>errno</code>ç›¸å…³çš„é”™è¯¯ã€‚å› æ­¤ï¼Œä¸Šé¢çš„ç¨‹åºå¯ä»¥ç›´æ¥ç”¨æ±‡ç¼–è¯­è¨€è¡¨ç¤ºä¸ºï¼š
<img alt="alt text" src="../image/image-96.png" /></p>
<h2 id="_11">è¿›ç¨‹<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<p>è¿›ç¨‹æ˜¯æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºçš„å®ä¾‹ï¼Œç³»ç»Ÿä¸­çš„æ¯ä¸ªç¨‹åºéƒ½åœ¨è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œã€‚ä¸Šä¸‹æ–‡ç”±ç¨‹åºæ­£ç¡®è¿è¡Œæ‰€éœ€çš„çŠ¶æ€ç»„æˆï¼ŒåŒ…æ‹¬å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ç¨‹åºä»£ç å’Œæ•°æ®ã€æ ˆã€é€šç”¨å¯„å­˜å™¨ä¸­çš„å†…å®¹ã€ç¨‹åºè®¡æ•°å™¨ã€ç¯å¢ƒå˜é‡ä»¥åŠæ‰“å¼€ <a href="https://en.wikipedia.org/wiki/File_descriptor">æ–‡ä»¶æè¿°ç¬¦</a> ã€‚</p>
<p>è¿›ç¨‹ä¸ºåº”ç”¨æä¾›äº†ä¸¤ä¸ªå…³é”®æŠ½è±¡ï¼š</p>
<ul>
<li>ä¸€ä¸ªç‹¬ç«‹çš„é€»è¾‘æ§åˆ¶æµï¼Œè®©æˆ‘ä»¬äº§ç”Ÿç¨‹åºç‹¬å å¤„ç†å™¨çš„é”™è§‰ï¼›</li>
<li>ä¸€ä¸ªç§æœ‰çš„åœ°å€ç©ºé—´ï¼Œè®©æˆ‘ä»¬äº§ç”Ÿç¨‹åºç‹¬å å†…å­˜çš„é”™è§‰ã€‚</li>
</ul>
<h3 id="_12">é€»è¾‘æ§åˆ¶æµ<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p><img alt="alt text" src="../image/image-97.png" /></p>
<p>è¿›ç¨‹è½®æµä½¿ç”¨å¤„ç†å™¨ã€‚æ¯ä¸ªè¿›ç¨‹æ‰§è¡Œå…¶æµç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œç„¶ååœ¨å…¶ä»–è¿›ç¨‹æ‰§è¡Œæ—¶è¢«æŠ¢å ï¼ˆå³æš‚æ—¶æŒ‚èµ·ï¼‰ã€‚</p>
<h3 id="_13">å¹¶å‘æµ<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p>æ‰§è¡Œæ—¶é—´é‡å çš„ä¸¤ä¸ªé€»è¾‘æ§åˆ¶æµè¢«ç§°ä¸ºå¹¶å‘æµï¼ˆConcurrent Flowï¼‰ï¼Œå®ƒä»¬å¹¶å‘è¿è¡Œã€‚å¦‚ä¸Šå›¾ 8.12 æ‰€ç¤ºï¼Œè¿›ç¨‹ A å’Œ è¿›ç¨‹ B å¹¶å‘è¿è¡Œï¼Œä½†è¿›ç¨‹ B å’Œè¿›ç¨‹ C åˆ™ä¸æ˜¯ã€‚</p>
<p>å¹¶å‘æµçš„æ¦‚å¿µä¸å¤„ç†å™¨çš„æ ¸æ•°ä»¥åŠè®¡ç®—æœºçš„æ•°é‡æ— å…³ï¼Œåªè¦ä¸¤ä¸ªé€»è¾‘æ§åˆ¶æµåœ¨æ—¶é—´ä¸Šé‡å ï¼Œé‚£ä¹ˆå®ƒä»¬ä¾¿æ˜¯å¹¶å‘çš„ã€‚å¦‚æœä¸¤ä¸ªé€»è¾‘æ§åˆ¶æµåœ¨ä¸åŒçš„å¤„ç†å™¨å†…æ ¸æˆ–è®¡ç®—æœºä¸ŠåŒæ—¶è¿è¡Œï¼Œæˆ‘ä»¬å°±ç§°å®ƒä»¬ä¸ºå¹¶è¡Œæµï¼ˆParallel Flowï¼‰ã€‚æ˜¾ç„¶ï¼Œå¹¶è¡Œæµæ˜¯å¹¶å‘æµçš„å­é›†ã€‚</p>
<h3 id="_14">ç§æœ‰åœ°å€ç©ºé—´<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<p>è¿›ç¨‹ä¸ºç¨‹åºæä¾›äº†ç‹¬äº«çš„ç§æœ‰åœ°å€ç©ºé—´ï¼Œä¸ç©ºé—´å†…ç‰¹å®šåœ°å€ç›¸å…³çš„å†…å­˜å­—èŠ‚é€šå¸¸ä¸èƒ½è¢«å…¶ä»–ä»»ä½•è¿›ç¨‹è¯»å–æˆ–å†™å…¥ã€‚å°½ç®¡ç§æœ‰åœ°å€ç©ºé—´çš„å†…å®¹ä¸åŒï¼Œä½†å…¶å…·æœ‰ç›¸åŒçš„ç»„ç»‡ç»“æ„ï¼ˆå›¾ä¸­çš„â€œ%espâ€åº”ä¸ºâ€œ%rspâ€ï¼‰ï¼š</p>
<p><img alt="alt text" src="../image/image-98.png" /></p>
<p>åœ°å€ç©ºé—´åº•éƒ¨æ˜¯ä¸ºç”¨æˆ·ç¨‹åºä¿ç•™çš„ï¼Œä»£ç æ®µæ€»æ˜¯ä»åœ°å€ 0x400000 å¼€å§‹ã€‚åœ°å€ç©ºé—´é¡¶éƒ¨æ˜¯ä¸ºå†…æ ¸ä¿ç•™çš„ï¼ŒåŒ…å«äº†å†…æ ¸ä¸ºè¿›ç¨‹æ‰§è¡ŒæŒ‡ä»¤ï¼ˆå¦‚ç³»ç»Ÿè°ƒç”¨ï¼‰æ—¶ä½¿ç”¨çš„ä»£ç ã€æ•°æ®å’Œæ ˆã€‚</p>
<h3 id="_15">ç”¨æˆ·æ€å’Œå†…æ ¸æ€<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<p>å¤„ç†å™¨é€šè¿‡ä¿å­˜åœ¨æ§åˆ¶å¯„å­˜å™¨ä¸­çš„æ¨¡å¼ä½ï¼ˆMode Bitï¼‰æ¥è¯†åˆ«è¿›ç¨‹å½“å‰äº«æœ‰çš„ç‰¹æƒã€‚å½“æ¨¡å¼ä½è¢«è®¾ç½®æ—¶ï¼Œè¿›ç¨‹è¿è¡Œåœ¨å†…æ ¸æ€ï¼ˆKernel Modeï¼‰ï¼Œåä¹‹åˆ™è¿è¡Œåœ¨ç”¨æˆ·æ€ï¼ˆUser Modeï¼‰ã€‚åœ¨å†…æ ¸æ€ä¸­è¿è¡Œçš„ç¨‹åºå¯ä»¥æ‰§è¡ŒæŒ‡ä»¤é›†ä¸­çš„ä»»æ„æŒ‡ä»¤ï¼Œå¹¶ä¸”èƒ½å¤Ÿè®¿é—®ç³»ç»Ÿä¸­çš„ä»»æ„ä½ç½®ã€‚è€Œåœ¨ç”¨æˆ·æ€ä¸­è¿è¡Œçš„ç¨‹åºåˆ™å—åˆ°é™åˆ¶ï¼Œåªèƒ½ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨é—´æ¥åœ°è®¿é—®å†…æ ¸ä»£ç å’Œæ•°æ®ã€‚</p>
<p>åº”ç”¨ç¨‹åºçš„è¿›ç¨‹åªèƒ½é€šè¿‡å¼‚å¸¸æ¥ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ã€‚å½“å¼‚å¸¸å‘ç”Ÿä¸”æ§åˆ¶è½¬ç§»åˆ°å¼‚å¸¸å¤„ç†ç¨‹åºæ—¶ï¼Œå¤„ç†å™¨åˆ‡æ¢åˆ°å†…æ ¸æ€ã€‚éšåå¼‚å¸¸å¤„ç†ç¨‹åºåœ¨å†…æ ¸æ€ä¸­è¿è¡Œï¼Œå¤„ç†å™¨å°†åœ¨å®ƒè¿”å›æ—¶åˆ‡æ¢å›ç”¨æˆ·æ€ã€‚</p>
<h3 id="_16">ä¸Šä¸‹æ–‡åˆ‡æ¢<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p>åœ¨è¿›ç¨‹æ‰§è¡ŒæœŸé—´ï¼Œå†…æ ¸å¯ä»¥æš‚æ—¶æŒ‚èµ·å½“å‰è¿›ç¨‹å¹¶é‡å¯å…ˆå‰è¢«æŠ¢å çš„è¿›ç¨‹ï¼Œè¿™ä¸€è¡Œä¸ºè¢«ç§°ä¸ºè°ƒåº¦ï¼ˆSchedulingï¼‰ã€‚å†…æ ¸è°ƒåº¦æ–°è¿›ç¨‹æ˜¯é€šè¿‡ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆContext Switchï¼‰æœºåˆ¶æ¥å®ç°çš„ï¼Œè¯¥æœºåˆ¶ï¼š</p>
<ul>
<li>ä¿å­˜å½“å‰è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ï¼›</li>
<li>æ¢å¤ä¹‹å‰è¢«æŠ¢å è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ï¼›</li>
<li>å°†æ§åˆ¶æƒè½¬ç§»ç»™æ–°è¿›ç¨‹ã€‚</li>
</ul>
<p>ç¨‹åºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨æ—¶å¯èƒ½ä¼šå‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚æ¯”å¦‚ç³»ç»Ÿè°ƒç”¨<code>read</code>éœ€è¦è®¿é—®ç£ç›˜ä¸­çš„æ•°æ®ï¼Œå†…æ ¸å¯ä»¥é€šè¿‡ä¸Šä¸‹æ–‡åˆ‡æ¢æ¥è°ƒåº¦å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™æ ·å°±æ— éœ€ç­‰å¾…æ•°æ®ä»ç£ç›˜åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</p>
<p><img alt="alt text" src="../image/image-99.png" /></p>
<h2 id="_17">ç³»ç»Ÿè°ƒç”¨é”™è¯¯å¤„ç†<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h2>
<p>å½“æ‰§è¡Œ Unix ç³»ç»Ÿçº§å‡½æ•°é‡åˆ°é”™è¯¯æ—¶ï¼Œå®ƒä»¬ä¼šè¿”å› -1 å¹¶è®¾ç½®å…¨å±€æ•´å‹å˜é‡<code>errno</code>çš„å€¼ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºä¸­æ£€æŸ¥è°ƒç”¨æ˜¯å¦å‘ç”Ÿé”™è¯¯ï¼Œå¦‚ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fork</span><span class="p">())</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="p">{</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">    </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;fork error: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="p">));</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>å…¶ä¸­ï¼Œ<code>strerror</code>å‡½æ•°ä¼šæ ¹æ®<code>errno</code>çš„å€¼è¿”å›ç›¸å…³çš„æ–‡æœ¬å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªé”™è¯¯æŠ¥å‘Šï¼ˆError-reportingï¼‰å‡½æ•°ä»¥ç®€åŒ–ä¸Šè¿°ä»£ç ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span>
<span class="normal"><a href="#__codelineno-2-4">4</a></span>
<span class="normal"><a href="#__codelineno-2-5">5</a></span>
<span class="normal"><a href="#__codelineno-2-6">6</a></span>
<span class="normal"><a href="#__codelineno-2-7">7</a></span>
<span class="normal"><a href="#__codelineno-2-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">unix_error</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="cm">/* Unix-style error */</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="p">{</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">    </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="p">));</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="p">}</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fork</span><span class="p">())</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">    </span><span class="n">unix_error</span><span class="p">(</span><span class="s">&quot;fork error&quot;</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>å½“ç„¶è¿˜å¯ä»¥è¿›ä¸€æ­¥åœ°å°†ä»£ç ç®€åŒ–ä¸ºä¸€ä¸ªé”™è¯¯å¤„ç†ï¼ˆError-handlingï¼‰å‡½æ•°ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span>
<span class="normal"><a href="#__codelineno-3-5">5</a></span>
<span class="normal"><a href="#__codelineno-3-6">6</a></span>
<span class="normal"><a href="#__codelineno-3-7">7</a></span>
<span class="normal"><a href="#__codelineno-3-8">8</a></span>
<span class="normal"><a href="#__codelineno-3-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kt">pid_t</span><span class="w"> </span><span class="nf">Fork</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="p">{</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">    </span><span class="kt">pid_t</span><span class="w"> </span><span class="n">pid</span><span class="p">;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fork</span><span class="p">())</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">        </span><span class="n">unix_error</span><span class="p">(</span><span class="s">&quot;Fork error&quot;</span><span class="p">);</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">pid</span><span class="p">;</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="p">}</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Fork</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
<p>è¿™æ ·æˆ‘ä»¬ä¾¿èƒ½å¤Ÿä½¿ç”¨åŒ…è£…å‡½æ•°<code>Fork</code>ä»£æ›¿<code>fork</code>åŠå…¶é”™è¯¯æ£€æŸ¥ä»£ç ã€‚æœ¬ä¹¦ä½¿ç”¨çš„åŒ…è£…å‡½æ•°å‡å®šä¹‰åœ¨ <a href="http://csapp.cs.cmu.edu/2e/ics2/code/include/csapp.h"><code>csapp.h</code></a> å’Œ  <a href="http://csapp.cs.cmu.edu/2e/ics2/code/src/csapp.c"><code>csapp.c</code></a> ä¸­ã€‚</p>
<h2 id="_18">è¿›ç¨‹æ§åˆ¶<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h2>
<h3 id="id">è·å–è¿›ç¨‹ ID<a class="headerlink" href="#id" title="Permanent link">&para;</a></h3>
<p>æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€ä¸”å¤§äº 0 çš„è¿›ç¨‹ IDï¼ˆPIDï¼‰ã€‚å‡½æ•°<code>getpid</code>è¿”å›è°ƒç”¨è¿›ç¨‹çš„ PIDï¼Œè€Œå‡½æ•°<code>getppid</code>åˆ™è¿”å›åˆ›å»ºè°ƒç”¨è¿›ç¨‹çš„è¿›ç¨‹ï¼ˆå³çˆ¶è¿›ç¨‹ï¼‰ çš„ PIDã€‚</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/types.h&gt;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="kt">pid_t</span><span class="w"> </span><span class="nf">getpid</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="kt">pid_t</span><span class="w"> </span><span class="nf">getppid</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>äºŒè€…è¿”å›å€¼çš„ç±»å‹å‡ä¸º<code>pid_t</code>ï¼Œå®ƒåœ¨ Linux ç³»ç»Ÿçš„<code>sys/types.h</code>æ–‡ä»¶ä¸­è¢«å®šä¹‰ä¸º<code>int</code>ã€‚</p>
<h3 id="_19">åˆ›å»ºå’Œç»ˆæ­¢è¿›ç¨‹<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<p>åœ¨ç¨‹åºå‘˜çœ‹æ¥ï¼Œè¿›ç¨‹æœ‰ä¸‰ç§çŠ¶æ€ï¼š</p>
<ul>
<li>è¿è¡Œï¼ˆRunningï¼‰ï¼šè¯¥è¿›ç¨‹è¦ä¹ˆåœ¨ CPU ä¸­æ‰§è¡Œï¼Œè¦ä¹ˆåœ¨ç­‰å¾…å†…æ ¸è°ƒåº¦ï¼›</li>
<li>åœæ­¢ï¼ˆStoppedï¼‰ï¼šè¿›ç¨‹æ‰§è¡Œæš‚åœï¼Œå¹¶ä¸”ä¸ä¼šè¢«è°ƒåº¦ï¼›</li>
<li>ç»ˆæ­¢ï¼ˆTerminatedï¼‰ï¼šè¿›ç¨‹æ°¸ä¹…åœ°åœæ­¢ã€‚</li>
</ul>
<p>å‡½æ•°<code>exit</code>ä¼šä»¥å‚æ•°<code>status</code>ä½œä¸ºé€€å‡ºçŠ¶æ€ç»ˆæ­¢è¿›ç¨‹ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="kt">void</span><span class="w"> </span><span class="nf">exit</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>çˆ¶è¿›ç¨‹å¯ä»¥è°ƒç”¨<code>fork</code>å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/types.h&gt;</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="kt">pid_t</span><span class="w"> </span><span class="nf">fork</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>å­è¿›ç¨‹å°†è·å¾—ä¸€ä¸ªä¸çˆ¶è¿›ç¨‹ç›¸åŒä½†ç‹¬ç«‹çš„ç”¨æˆ·çº§è™šæ‹Ÿå†…å­˜ç©ºé—´å‰¯æœ¬ï¼ŒåŒ…æ‹¬ä»£ç ã€æ•°æ®ã€å †ã€å…±äº«åº“å’Œç”¨æˆ·æ ˆç­‰ã€‚å®ƒè¿˜ä¼šå¾—åˆ°ä¸çˆ¶è¿›ç¨‹ç›¸åŒçš„æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦å‰¯æœ¬ï¼Œå› æ­¤èƒ½å¤Ÿè¯»å†™ä»»æ„çˆ¶è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶ã€‚çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ä¹‹é—´æœ€æ˜¾è‘—çš„åŒºåˆ«ä¾¿æ˜¯ PID ä¸åŒã€‚</p>
<p>å‡½æ•°<code>fork</code>æ‰§è¡Œä¸€æ¬¡å´è¿”å›ä¸¤æ¬¡ï¼šåœ¨çˆ¶è¿›ç¨‹ä¸­è¿”å›å­è¿›ç¨‹çš„ PIDï¼Œåœ¨å­è¿›ç¨‹ä¸­è¿”å› 0ã€‚ç”±äºå­è¿›ç¨‹çš„ PID å§‹ç»ˆå¤§äº 0 ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿”å›å€¼åˆ¤æ–­ç¨‹åºåœ¨å“ªä¸ªè¿›ç¨‹ä¸­æ‰§è¡Œã€‚</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;csapp.h&quot;</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="p">{</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">    </span><span class="kt">pid_t</span><span class="w"> </span><span class="n">pid</span><span class="p">;</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="w">    </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Fork</span><span class="p">();</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pid</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="cm">/* Child */</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;child : x=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">++</span><span class="n">x</span><span class="p">);</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="w">    </span><span class="cm">/* Parent */</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;parent: x=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">x</span><span class="p">);</span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a><span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>è¯¥ç¨‹åºç¼–è¯‘åè¿è¡Œçš„å¯èƒ½ç»“æœä¸ºï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>linux&gt;<span class="w"> </span>./fork
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>parent:<span class="w"> </span><span class="nv">x</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a>child<span class="w"> </span>:<span class="w"> </span><span class="nv">x</span><span class="o">=</span><span class="m">2</span>
</code></pre></div></td></tr></table></div>
<p>ä»ç»“æœæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼šçˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹å¹¶å‘æ‰§è¡Œï¼Œæˆ‘ä»¬æ°¸è¿œæ— æ³•é¢„æµ‹å…¶æ‰§è¡Œé¡ºåºï¼›å­è¿›ç¨‹çš„åœ°å€ç©ºé—´æ˜¯çˆ¶è¿›ç¨‹çš„å‰¯æœ¬ï¼Œå› æ­¤å½“ç¬¬å…­è¡Œçš„å‡½æ•°<code>Fork</code>è¿”å›æ—¶ï¼Œä¸¤è¿›ç¨‹ä¸­çš„å±€éƒ¨å˜é‡<code>x</code>å‡ä¸º 1ï¼›ä¸¤è¿›ç¨‹å¯¹å˜é‡çš„æ›´æ”¹äº’ä¸å½±å“ï¼Œæ‰€ä»¥æœ€ç»ˆè¾“å‡ºçš„å€¼ä¸åŒã€‚</p>
<p>ç»˜åˆ¶è¿›ç¨‹å›¾ï¼ˆProcess Graphï¼‰å¯¹ç†è§£<code>fork</code>å‡½æ•°å¾ˆæœ‰å¸®åŠ©ï¼Œå¦‚ï¼š</p>
<p><img alt="alt text" src="../image/image-100.png" /></p>
<h3 id="_20">å›æ”¶å­è¿›ç¨‹<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<p>è¿›ç¨‹ç»ˆæ­¢åï¼Œå†…æ ¸ä¸ä¼šç«‹å³å°†å…¶ç§»é™¤ã€‚å®ƒéœ€è¦è¢«å…¶çˆ¶è¿›ç¨‹å›æ”¶ï¼ˆReapï¼‰ï¼Œå¦åˆ™å°†æˆä¸ºåƒµå°¸ï¼ˆZombieï¼‰è¿›ç¨‹ã€‚å½“çˆ¶è¿›ç¨‹å›æ”¶å…¶ç»ˆæ­¢çš„å­è¿›ç¨‹æ—¶ï¼Œå†…æ ¸å°†å­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ä¼ é€’ç»™çˆ¶è¿›ç¨‹ï¼Œç„¶åå†ä¸¢å¼ƒå®ƒã€‚</p>
<p>å¦‚æœçˆ¶è¿›ç¨‹ç»ˆæ­¢ï¼Œå†…æ ¸ä¼šå®‰æ’<code>init</code>è¿›ç¨‹ï¼ˆPID ä¸º 1ï¼‰â€œæ”¶å…»â€å­¤å„¿è¿›ç¨‹ï¼›å¦‚æœçˆ¶è¿›ç¨‹åœ¨ç»ˆæ­¢å‰æ²¡æœ‰å›æ”¶åƒµå°¸å­è¿›ç¨‹ï¼Œé‚£ä¹ˆåˆ™ç”±<code>init</code>è¿›ç¨‹å›æ”¶å®ƒä»¬ã€‚</p>
<p>è¿›ç¨‹é€šè¿‡è°ƒç”¨å‡½æ•°<code>waitpid</code>ç­‰å¾…å…¶å­è¿›ç¨‹ç»ˆæ­¢æˆ–åœæ­¢ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/types.h&gt;</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/wait.h&gt;</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="kt">pid_t</span><span class="w"> </span><span class="nf">waitpid</span><span class="p">(</span><span class="kt">pid_t</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">statusp</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">options</span><span class="p">);</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="c1">// Returns: PID of child if OK, 0 (if WNOHANG), or âˆ’1 on error</span>
</code></pre></div></td></tr></table></div>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ˆå‚æ•°<code>options</code>ä¸º 0 æ—¶ï¼‰ï¼Œå‡½æ•°<code>waitpid</code>ä¼šæš‚åœè°ƒç”¨è¿›ç¨‹ï¼Œç›´è‡³å…¶ç­‰å¾…é›†ï¼ˆWait Setï¼‰ä¸­çš„æŸä¸ªå­è¿›ç¨‹ç»ˆæ­¢ã€‚è¯¥å‡½æ•°å§‹ç»ˆè¿”å›ç¬¬ä¸€ä¸ªç»ˆæ­¢çš„å­è¿›ç¨‹ PIDã€‚æ­¤æ—¶ï¼Œç»ˆæ­¢çš„å­è¿›ç¨‹å·²è¢«å›æ”¶ï¼Œå†…æ ¸ä»ç³»ç»Ÿä¸­åˆ é™¤äº†å®ƒçš„æ‰€æœ‰ç—•è¿¹ã€‚</p>
<p>è‹¥å‚æ•°<code>pid_t</code>å¤§äº 0 ï¼Œåˆ™ç­‰å¾…é›†ä¸­åªæœ‰ä¸€ä¸ª PID ä¸è¯¥å‚æ•°ç›¸ç­‰çš„å­è¿›ç¨‹ã€‚è‹¥å‚æ•°<code>pid_t</code>ç­‰äº -1ï¼Œåˆ™ç­‰å¾…é›†åŒ…å«è°ƒç”¨è¿›ç¨‹çš„æ‰€æœ‰å­è¿›ç¨‹ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹å‚æ•°<code>options</code>çš„å€¼æ¥æ”¹å˜å‡½æ•°<code>waitpid</code>çš„è¡Œä¸ºï¼š</p>
<ul>
<li><code>WNOHANG</code>ï¼šå¦‚æœç­‰å¾…é›†ä¸­çš„å­è¿›ç¨‹è¿˜æœªç»ˆæ­¢ï¼Œåˆ™ç«‹å³è¿”å› 0ï¼›</li>
<li><code>WUNTRACED</code>ï¼šæš‚åœè°ƒç”¨è¿›ç¨‹æ‰§è¡Œï¼Œç›´åˆ°ç­‰å¾…é›†ä¸­çš„è¿›ç¨‹ç»ˆæ­¢æˆ–åœæ­¢ï¼ˆé»˜è®¤æƒ…å†µä¸‹ä»…è¿”å›ç»ˆæ­¢çš„å­è¿›ç¨‹ PIDï¼‰ï¼›</li>
<li><code>WCONTINUED</code>ï¼šæš‚åœè°ƒç”¨è¿›ç¨‹æ‰§è¡Œï¼Œç›´åˆ°ç­‰å¾…é›†ä¸­çš„è¿›ç¨‹ç»ˆæ­¢æˆ–ç­‰å¾…é›†ä¸­åœæ­¢çš„è¿›ç¨‹æ”¶åˆ° SIGCONT ä¿¡å·æ¢å¤ã€‚</li>
</ul>
<p>è‹¥å‚æ•°<code>statusp</code>ä¸ä¸º<code>NULL</code>ï¼Œé‚£ä¹ˆ<code>waitpid</code>è¿˜ä¼šå°†è¿”å›çš„å­è¿›ç¨‹çŠ¶æ€ä¿¡æ¯ç¼–ç åˆ°<code>status</code>ä¸­ï¼ˆ<code>*statusp = status</code>ï¼‰ã€‚<code>wait.h</code>æ–‡ä»¶å®šä¹‰äº†å‡ ä¸ªç”¨äºè§£é‡Šå‚æ•°<code>status</code>çš„å®ï¼š</p>
<ul>
<li><code>WIFEXITED(status)</code>ï¼šå¦‚æœå­è¿›ç¨‹æ­£å¸¸ç»ˆæ­¢ï¼ˆæ¯”å¦‚è°ƒç”¨<code>exit</code>æˆ–è¿”å›ï¼‰ï¼Œåˆ™è¿”å›<code>True</code>ï¼›</li>
<li><code>WEXITSTATUS(status)</code>ï¼šå¦‚æœ<code>WIFEXITED()</code>è¿”å›<code>True</code>ï¼Œåˆ™è¿”å›ç»ˆæ­¢å­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ï¼›</li>
<li><code>WIFSIGNALED(status)</code>ï¼šå¦‚æœå­è¿›ç¨‹ç”±äºæœªæ•è·çš„ä¿¡å·è€Œç»ˆæ­¢ï¼Œåˆ™è¿”å›<code>True</code>ï¼›</li>
<li><code>WTERMSIG(status)</code>ï¼šå¦‚æœ<code>WIFSIGNALED()</code>è¿”å›<code>True</code>ï¼Œåˆ™è¿”å›å¯¼è‡´å­è¿›ç¨‹ç»ˆæ­¢çš„ä¿¡å·ç¼–å·ï¼›</li>
<li><code>WIFSTOPPED(status)</code>ï¼šå¦‚æœè¿”å›çš„å­è¿›ç¨‹å½“å‰å·²åœæ­¢ï¼Œåˆ™è¿”å›<code>True</code>ï¼›</li>
<li><code>WSTOPSIG(status)</code>ï¼šå¦‚æœ<code>WIFSTOPPED()</code>è¿”å›<code>True</code>ï¼Œåˆ™è¿”å›å¯¼è‡´å­è¿›ç¨‹åœæ­¢çš„ä¿¡å·ç¼–å·ï¼›</li>
<li><code>WIFCONTINUED(status)</code>ï¼šå¦‚æœå­è¿›ç¨‹æ”¶åˆ° SIGCONT ä¿¡å·åæ¢å¤ï¼Œåˆ™è¿”å›<code>True</code>ã€‚</li>
</ul>
<p>å¦‚æœè°ƒç”¨è¿›ç¨‹æ²¡æœ‰å­è¿›ç¨‹ï¼Œ<code>waitpid</code>å°†è¿”å› -1 å¹¶å°†å…¨å±€å˜é‡<code>errno</code>è®¾ä¸º<code>ECHILD</code>ï¼›å¦‚æœ<code>waitpid</code>è¢«ä¿¡å·ä¸­æ–­ï¼Œåˆ™è¿”å› -1 å¹¶å°†å…¨å±€å˜é‡<code>errno</code>è®¾ä¸º<code>EINTR</code>ã€‚</p>
<p>å‡½æ•°<code>wait</code>æ˜¯<code>waitpid</code>çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œ<code>wait(&amp;status)</code>ç­‰æ•ˆäº<code>waitpid(-1, &amp;status, 0)</code>ã€‚</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span>
<span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span>
<span class="normal"><a href="#__codelineno-10-17">17</a></span>
<span class="normal"><a href="#__codelineno-10-18">18</a></span>
<span class="normal"><a href="#__codelineno-10-19">19</a></span>
<span class="normal"><a href="#__codelineno-10-20">20</a></span>
<span class="normal"><a href="#__codelineno-10-21">21</a></span>
<span class="normal"><a href="#__codelineno-10-22">22</a></span>
<span class="normal"><a href="#__codelineno-10-23">23</a></span>
<span class="normal"><a href="#__codelineno-10-24">24</a></span>
<span class="normal"><a href="#__codelineno-10-25">25</a></span>
<span class="normal"><a href="#__codelineno-10-26">26</a></span>
<span class="normal"><a href="#__codelineno-10-27">27</a></span>
<span class="normal"><a href="#__codelineno-10-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;csapp.h&quot;</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="cp">#define N 2</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="p">{</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="w">    </span><span class="kt">pid_t</span><span class="w"> </span><span class="n">pid</span><span class="p">;</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="w">    </span><span class="cm">/* Parent creates N children */</span>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Fork</span><span class="p">())</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="cm">/* child */</span>
<a id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="w">            </span><span class="n">exit</span><span class="p">(</span><span class="mi">100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<a id="__codelineno-10-13" name="__codelineno-10-13"></a>
<a id="__codelineno-10-14" name="__codelineno-10-14"></a><span class="w">    </span><span class="cm">/* Parent reaps N children in no particular order */</span>
<a id="__codelineno-10-15" name="__codelineno-10-15"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">waitpid</span><span class="p">(</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-10-16" name="__codelineno-10-16"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-10-17" name="__codelineno-10-17"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">WIFEXITED</span><span class="p">(</span><span class="n">status</span><span class="p">))</span>
<a id="__codelineno-10-18" name="__codelineno-10-18"></a><span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;child %d terminated normally with exit status=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">WEXITSTATUS</span><span class="p">(</span><span class="n">status</span><span class="p">));</span>
<a id="__codelineno-10-19" name="__codelineno-10-19"></a><span class="w">        </span><span class="k">else</span>
<a id="__codelineno-10-20" name="__codelineno-10-20"></a><span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;child %d terminated abnormally</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">);</span>
<a id="__codelineno-10-21" name="__codelineno-10-21"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-22" name="__codelineno-10-22"></a>
<a id="__codelineno-10-23" name="__codelineno-10-23"></a><span class="w">    </span><span class="cm">/* The only normal termination is if there are no more children */</span>
<a id="__codelineno-10-24" name="__codelineno-10-24"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">errno</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ECHILD</span><span class="p">)</span>
<a id="__codelineno-10-25" name="__codelineno-10-25"></a><span class="w">        </span><span class="n">unix_error</span><span class="p">(</span><span class="s">&quot;waitpid error&quot;</span><span class="p">);</span>
<a id="__codelineno-10-26" name="__codelineno-10-26"></a>
<a id="__codelineno-10-27" name="__codelineno-10-27"></a><span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-10-28" name="__codelineno-10-28"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>å¦‚ç¤ºä¾‹ç¨‹åºæ‰€ç¤ºï¼Œçˆ¶è¿›ç¨‹é¦–å…ˆè°ƒç”¨<code>Fork</code>åˆ›å»ºäº†ä¸¤ä¸ªé€€å‡ºçŠ¶æ€å”¯ä¸€çš„å­è¿›ç¨‹ï¼ˆ<code>exit(100+i)</code>ï¼‰ã€‚ éšååœ¨ While å¾ªç¯çš„æµ‹è¯•æ¡ä»¶ä¸­é€šè¿‡<code>waitpid</code>ç­‰å¾…å…¶æ‰€æœ‰çš„å­è¿›ç¨‹ç»ˆæ­¢ï¼Œå¹¶æ‰“å°å­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ã€‚æœ€ç»ˆæ‰€æœ‰çš„å­è¿›ç¨‹å‡è¢«å›æ”¶ï¼Œ<code>waitpid</code>è¿”å› -1 ä¸”å°†å…¨å±€å˜é‡<code>errno</code>è®¾ä¸º<code>ECHILD</code>ï¼Œå‡½æ•°æ‰§è¡Œå®Œæ¯•ã€‚</p>
<p>åœ¨ Linux ç³»ç»Ÿä¸Šè¿è¡Œè¯¥ç¨‹åºæ—¶ï¼Œå®ƒä¼šäº§ç”Ÿä»¥ä¸‹è¾“å‡ºï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">linux</span><span class="o">&gt;</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">waitpid1</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="n">child</span><span class="w"> </span><span class="mi">22966</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="mi">100</span><span class="w"> </span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="n">child</span><span class="w"> </span><span class="mi">22967</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="mi">101</span>
</code></pre></div></td></tr></table></div>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œçˆ¶è¿›ç¨‹å›æ”¶å­è¿›ç¨‹çš„é¡ºåºæ˜¯éšæœºçš„ã€‚æˆ‘ä»¬å¯ä»¥å¯¹ä¸Šè¿°ç¨‹åºè¿›è¡Œä¸€å®š <a href="http://csapp.cs.cmu.edu/2e/ics2/code/ecf/waitpid2.c">ä¿®æ”¹</a>ï¼Œä»è€Œä½¿å…¶æŒ‰å­è¿›ç¨‹çš„ PID é¡ºåºè¾“å‡ºã€‚</p>
<h3 id="_21">è®©è¿›ç¨‹ä¼‘çœ <a class="headerlink" href="#_21" title="Permanent link">&para;</a></h3>
<p>å‡½æ•°<code>sleep</code>å¯ä»¥è®©è¿›ç¨‹æš‚åœæ‰§è¡Œä¸€æ®µæ—¶é—´ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">sleep</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">secs</span><span class="p">);</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="c1">// Returns: seconds left to sleep</span>
</code></pre></div></td></tr></table></div>
<p>å¦‚æœè¯·æ±‚çš„æš‚åœæ—¶é—´å·²ç»è¿‡å»ï¼Œåˆ™å‡½æ•°è¿”å› 0ï¼›å¦‚æœè¯¥è¿›ç¨‹è¢«ä¿¡å·ä¸­æ–­ï¼Œåˆ™è¿”å›å‰©ä½™çš„æš‚åœæ—¶é—´ã€‚</p>
<p>å‡½æ•°<code>pause</code>ä¼šä½¿è°ƒç”¨è¿›ç¨‹è¿›å…¥ä¼‘çœ çŠ¶æ€ï¼Œç›´è‡³æ”¶åˆ°ä¿¡å·ã€‚è¯¥å‡½æ•°å§‹ç»ˆè¿”å› -1:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="kt">int</span><span class="w"> </span><span class="nf">pause</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<h3 id="_22">åŠ è½½å¹¶è¿è¡Œç¨‹åº<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h3>
<p>å‡½æ•°<code>execve</code>åœ¨å½“å‰è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­åŠ è½½å¹¶è¿è¡Œä¸€ä¸ªæ–°ç¨‹åºï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="kt">int</span><span class="w"> </span><span class="nf">execve</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[],</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">envp</span><span class="p">[]);</span>
</code></pre></div></td></tr></table></div>
<p>å‚æ•°<code>filename</code>æ˜¯åŠ è½½å¹¶è¿è¡Œçš„å¯æ‰§è¡Œæ–‡ä»¶åç§°ï¼Œ<code>argv</code>å’Œ<code>envp</code>åˆ™åˆ†åˆ«æ˜¯å‚æ•°å’Œç¯å¢ƒå˜é‡åˆ—è¡¨ã€‚å‡½æ•°<code>execve</code>é€šå¸¸æ²¡æœ‰è¿”å›å€¼ï¼Œä»…åœ¨å‡ºç°é”™è¯¯æ—¶è¿”å› -1ã€‚</p>
<p>å˜é‡<code>argv</code>æŒ‡å‘ä¸€ä¸ªä»¥<code>NULL</code>ä¸ºç»“å°¾çš„æŒ‡é’ˆæ•°ç»„ï¼Œå…¶ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æŒ‡å‘ä¸€ä¸ªå‚æ•°å­—ç¬¦ä¸²ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œ<code>argv[0]</code>æ˜¯å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶åç§°ï¼›å˜é‡<code>envp</code>ä¹ŸæŒ‡å‘ä¸€ä¸ªä»¥<code>NULL</code>ç»“å°¾çš„æŒ‡é’ˆæ•°ç»„ï¼Œå…¶ä¸­çš„æ¯ä¸ªå…ƒç´ å‡æŒ‡å‘ä¸€ä¸ªç¯å¢ƒå˜é‡å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯ä¸€ä¸ª<code>name=value</code>å½¢å¼çš„é”®å€¼å¯¹ã€‚ä¸¤è€…çš„æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š</p>
<p><img alt="alt text" src="../image/image-101.png" />
<code>execve</code>åŠ è½½æ–‡ä»¶ååï¼Œä¼šè°ƒç”¨å¯åŠ¨ä»£ç ã€‚ å¯åŠ¨ä»£ç è®¾ç½®æ ˆå¹¶å°†æ§åˆ¶æƒä¼ é€’ç»™æ–°ç¨‹åºçš„<code>main</code>å‡½æ•°ï¼Œå…¶åŸå‹ä¸ºï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[],</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">envp</span><span class="p">[]);</span>
</code></pre></div></td></tr></table></div>
<p><code>main</code>å‡½æ•°æ‰§è¡Œæ—¶çš„ç”¨æˆ·æ ˆç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»æ ˆåº•åˆ°æ ˆé¡¶åˆ†åˆ«æ˜¯ï¼šç¯å¢ƒå˜é‡å­—ç¬¦ä¸²ã€å‚æ•°å­—ç¬¦ä¸²ã€æŒ‡å‘ç¯å¢ƒå˜é‡å­—ç¬¦ä¸²çš„æŒ‡é’ˆæ•°ç»„å’ŒæŒ‡å‘å‚æ•°å­—ç¬¦ä¸²çš„æŒ‡é’ˆæ•°ç»„ã€‚è¯¥å‡½æ•°çš„ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¿å­˜åœ¨ä¸åŒçš„å¯„å­˜å™¨ä¸­ï¼šå‚æ•°<code>argc</code>ç»™å‡ºæ•°ç»„<code>argv[]</code>ä¸­çš„éç©ºæŒ‡é’ˆæ•°é‡ï¼›å‚æ•°<code>argv</code>æŒ‡å‘æ•°ç»„<code>argv[]</code>ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›å‚æ•°<code>envp</code>åˆ™æŒ‡å‘æ•°ç»„<code>envp[]</code>ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š</p>
<p><img alt="alt text" src="../image/image-102.png" />
Linux æä¾›äº†å‡ ä¸ªç”¨äºæ“ä½œç¯å¢ƒå˜é‡æ•°ç»„çš„å‡½æ•°ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span>
<span class="normal"><a href="#__codelineno-16-3">3</a></span>
<span class="normal"><a href="#__codelineno-16-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="nf">getenv</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">);</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="kt">int</span><span class="w"> </span><span class="nf">setenv</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">newvalue</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">overwrite</span><span class="p">);</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="kt">void</span><span class="w"> </span><span class="nf">unsetenv</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>å¦‚æœæ•°ç»„ä¸­åŒ…å«ä»¥å‚æ•°<code>name</code>ä¸ºé”®çš„å­—ç¬¦ä¸²ï¼Œåˆ™å‡½æ•°<code>getenv</code>è¿”å›å…¶å¯¹åº”çš„å€¼ï¼Œå‡½æ•°<code>unsetenv</code>åˆ é™¤è¯¥å­—ç¬¦ä¸²ï¼Œå‡½æ•°<code>setenv</code>å°†å€¼æ›¿æ¢ä¸ºå‚æ•°<code>newvalue</code>ï¼ˆ<code>overwrite</code>éé›¶æ—¶ï¼‰ï¼›å¦‚æœä¸å­˜åœ¨ä»¥<code>name</code>ä¸ºé”®çš„å­—ç¬¦ä¸²ï¼Œåˆ™å‡½æ•°<code>setenv</code>ä¼šå°†<code>name=newvalue</code>æ·»åŠ åˆ°æ•°ç»„ä¸­ã€‚</p>
<h3 id="fork-execve">ä½¿ç”¨ fork å’Œ execve è¿è¡Œç¨‹åº<a class="headerlink" href="#fork-execve" title="Permanent link">&para;</a></h3>
<p>Unix shell å’Œ Web æœåŠ¡å™¨ç­‰ç¨‹åºå¤§é‡ä½¿ç”¨äº†<code>fork</code>å’Œ<code>execve</code>å‡½æ•°ã€‚æœ¬ä¹¦æä¾›äº†ä¸€ä¸ªç®€å•çš„ <a href="http://csapp.cs.cmu.edu/2e/ics2/code/ecf/shellex.c">shell ç¨‹åº</a>ï¼Œå…¶ç¼ºé™·åœ¨äºæ²¡æœ‰å›æ”¶ä»»ä½•åå°è¿è¡Œçš„å­è¿›ç¨‹ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸‹ä¸€èŠ‚ä»‹ç»çš„ä¿¡å·æ¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p>
<h2 id="_23">ä¿¡å·<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h2>
<p>ä¿¡å·ï¼ˆSignalï¼‰æ˜¯ä¸€ç§é«˜çº§çš„å¼‚å¸¸æ§åˆ¶æµï¼Œå®ƒå…è®¸è¿›ç¨‹å’Œå†…æ ¸å°†æŸäº›ç±»å‹çš„ç³»ç»Ÿäº‹ä»¶é€šçŸ¥ç»™å…¶ä»–è¿›ç¨‹ã€‚Linux æ”¯æŒçš„ä¿¡å·ç±»å‹å¤šè¾¾ä¸‰åç§ï¼š</p>
<p><img alt="alt text" src="../image/image-103.png" />
ä½çº§åˆ«çš„ç¡¬ä»¶å¼‚å¸¸ç”±å†…æ ¸ä¸­çš„å¼‚å¸¸å¤„ç†ç¨‹åºå¤„ç†ï¼Œé€šå¸¸ä¸ä¼šå¯¹ç”¨æˆ·è¿›ç¨‹å¯è§ï¼Œè€Œä¿¡å·åˆ™å¯ä»¥å°†æ­¤ç±»å¼‚å¸¸æš´éœ²ç»™ç”¨æˆ·è¿›ç¨‹ã€‚å¦‚æœä¸€ä¸ªè¿›ç¨‹è¯•å›¾é™¤ä»¥ 0ï¼Œå†…æ ¸å°±ä¼šå‘å®ƒå‘é€ä¸€ä¸ª SIGFPEï¼ˆç¼–å· 8ï¼‰ä¿¡å·ã€‚</p>
<h3 id="_24">ä¿¡å·æœ¯è¯­<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h3>
<p>å‘é€ä¿¡å·åˆ°ç›®æ ‡è¿›ç¨‹éœ€è¦å®Œæˆä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>å‘é€ï¼ˆä¼ é€’ï¼‰ä¿¡å·ï¼šå†…æ ¸é€šè¿‡æ›´æ–°ç›®æ ‡è¿›ç¨‹ä¸Šä¸‹æ–‡ä¸­çš„æŸäº›çŠ¶æ€æ¥å‘ç›®æ ‡è¿›ç¨‹å‘é€ä¿¡å·ã€‚å‘é€ä¿¡å·çš„åŸå› æœ‰ä¸¤ç§ï¼šâ‘  å†…æ ¸æ£€æµ‹åˆ°ç³»ç»Ÿäº‹ä»¶çš„å‘ç”Ÿï¼Œå¦‚è¢« 0 é™¤é”™è¯¯æˆ–å­è¿›ç¨‹ç»ˆæ­¢ç­‰ï¼›â‘¡ è¿›ç¨‹è°ƒç”¨äº†<code>kill</code>å‡½æ•°ï¼ˆå°†åœ¨ä¸‹ä¸€èŠ‚ä»‹ç»ï¼‰ã€‚è¿›ç¨‹å¯ä»¥å‘è‡ªå·±å‘é€ä¿¡å·ï¼›</li>
<li>æ¥æ”¶ä¿¡å·ï¼šå½“å†…æ ¸å¼ºåˆ¶ç›®æ ‡è¿›ç¨‹ä»¥æŸç§æ–¹å¼å¯¹ä¿¡å·åšå‡ºå“åº”æ—¶ï¼Œå®ƒä¾¿æ¥æ”¶åˆ°äº†ä¿¡å·ã€‚è¯¥è¿›ç¨‹å¯ä»¥é€šè¿‡æ‰§è¡Œç”¨æˆ·çº§åˆ«çš„ä¿¡å·å¤„ç†ç¨‹åºï¼ˆSignal Handlerï¼‰æ¥å¿½ç•¥ã€ç»ˆæ­¢æˆ–æ•è·ä¿¡å·ã€‚</li>
</ol>
<p><img alt="alt text" src="../image/image-104.png" />
å·²å‘é€ä½†è¿˜æœªæ¥æ”¶çš„ä¿¡å·è¢«ç§°ä¸ºå¾…å¤„ç†ä¿¡å·ï¼ˆPending Signalï¼‰ã€‚åœ¨ä»»æ„æ—¶é—´ç‚¹ï¼Œç›¸åŒç±»å‹çš„å¾…å¤„ç†ä¿¡å·æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªã€‚è¿™æ„å‘³ç€å¦‚æœä¸€ä¸ªè¿›ç¨‹å·²ç»æœ‰ä¸€ä¸ªç±»å‹ä¸º k çš„å¾…å¤„ç†ä¿¡å·ï¼Œé‚£ä¹ˆåç»­æ‰€æœ‰å‘é€ç»™è¯¥è¿›ç¨‹çš„ k ç±»å‹ä¿¡å·éƒ½å°†è¢«ä¸¢å¼ƒã€‚è¿›ç¨‹è¿˜å¯ä»¥é€‰æ‹©æ€§åœ°é˜»å¡ï¼ˆBlockï¼‰æŸäº›ä¿¡å·çš„æ¥æ”¶ã€‚</p>
<h3 id="_25">å‘é€ä¿¡å·<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h3>
<h4 id="_26">è¿›ç¨‹ç»„<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h4>
<p>æ¯ä¸ªè¿›ç¨‹éƒ½å±äºä¸€ä¸ªè¿›ç¨‹ç»„ï¼ˆProcess Groupï¼‰ï¼Œå®ƒç”±ä¸€ä¸ªæ­£æ•´æ•°çš„è¿›ç¨‹ç»„ ID æ‰€æ ‡è¯†ã€‚<code>getpgrp</code>å‡½æ•°è¿”å›å½“å‰è¿›ç¨‹çš„è¿›ç¨‹ç»„ IDï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span>
<span class="normal"><a href="#__codelineno-17-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="kt">pid_t</span><span class="w"> </span><span class="nf">getpgrp</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå­è¿›ç¨‹ä¸å…¶çˆ¶è¿›ç¨‹å±äºåŒä¸€ä¸ªè¿›ç¨‹ç»„ã€‚è¿›ç¨‹å¯ä»¥é€šè¿‡<code>setpgid</code>å‡½æ•°æ”¹å˜è‡ªå·±æˆ–å¦ä¸€ä¸ªè¿›ç¨‹çš„è¿›ç¨‹ç»„ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="kt">int</span><span class="w"> </span><span class="nf">setpgid</span><span class="p">(</span><span class="kt">pid_t</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="kt">pid_t</span><span class="w"> </span><span class="n">pgid</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>è¯¥å‡½æ•°ä¼šæŠŠè¿›ç¨‹<code>pid</code>çš„è¿›ç¨‹ç»„æ›´æ”¹ä¸º<code>pgid</code>ã€‚è‹¥å°†å‚æ•°<code>pid</code>æˆ–<code>pgid</code>è®¾ä¸º 0ï¼Œåˆ™ç›¸å½“äºä½¿ç”¨è°ƒç”¨è¿›ç¨‹çš„ PID ä½œä¸ºå‚æ•°ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœè¿›ç¨‹ 15213 è°ƒç”¨å‡½æ•°<code>setpgid(0, 0)</code>ï¼Œé‚£ä¹ˆå°†ä¼šåˆ›å»ºä¸€ä¸ªè¿›ç¨‹ç»„ ID ä¸º 15213 çš„æ–°è¿›ç¨‹ç»„ï¼Œå¹¶ä½¿è¯¥è¿›ç¨‹åŠ å…¥æ­¤ç»„ã€‚</p>
<h4 id="_27">ä»é”®ç›˜å‘é€ä¿¡å·<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h4>
<p>Unix Shell ä½¿ç”¨ä»»åŠ¡ï¼ˆJobï¼‰è¡¨ç¤ºå•ä¸ªå‘½ä»¤è¡Œï¼ˆå¦‚<code>ls | sort</code>ï¼‰åˆ›å»ºçš„è¿›ç¨‹ï¼ŒåŒä¸€æ—¶é—´å†…åªèƒ½æœ‰ä¸€ä¸ªå‰å°ä»»åŠ¡å’Œå¤šä¸ªåå°ä»»åŠ¡ã€‚</p>
<p><img alt="alt text" src="../image/image-105.png" />
åœ¨é”®ç›˜ä¸Šè¾“å…¥ Ctrl+C ä¼šä½¿å†…æ ¸å‘å‰å°è¿›ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹å‘é€ SIGINT ä¿¡å·ï¼Œè¿™å°†ç»ˆæ­¢å‰å°ä»»åŠ¡ã€‚åŒæ ·ï¼Œè¾“å…¥ Ctrl+Z ä¼šä½¿å†…æ ¸å‘å‰å°è¿›ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹å‘é€ SIGTSTP ä¿¡å·ï¼Œè¿™å°†åœæ­¢ï¼ˆæŒ‚èµ·ï¼‰å‰å°ä»»åŠ¡ã€‚</p>
<h4 id="kill">ä½¿ç”¨ kill å‡½æ•°å‘é€ä¿¡å·<a class="headerlink" href="#kill" title="Permanent link">&para;</a></h4>
<p>è¿›ç¨‹å¯ä»¥è°ƒç”¨<code>kill</code>å‡½æ•°å‘å…¶ä»–è¿›ç¨‹ï¼ˆåŒ…æ‹¬å…¶è‡ªèº«ï¼‰å‘é€ä¿¡å·ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span>
<span class="normal"><a href="#__codelineno-19-2">2</a></span>
<span class="normal"><a href="#__codelineno-19-3">3</a></span>
<span class="normal"><a href="#__codelineno-19-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/types.h&gt;</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;signal.h&gt;</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="kt">int</span><span class="w"> </span><span class="nf">kill</span><span class="p">(</span><span class="kt">pid_t</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">sig</span><span class="p">);</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="c1">// Returns: 0 if OK, âˆ’1 on error</span>
</code></pre></div></td></tr></table></div>
<p>è‹¥å‚æ•°<code>pid</code>å¤§äº 0ï¼Œåˆ™è¯¥å‡½æ•°å°†ç¼–å·ä¸º<code>sig</code>çš„ä¿¡å·å‘é€ç»™è¿›ç¨‹<code>pid</code>ï¼›è‹¥å‚æ•°<code>pid</code>ç­‰äº 0ï¼Œåˆ™è¯¥å‡½æ•°å°†ä¿¡å·å‘é€ç»™è°ƒç”¨è¿›ç¨‹æ‰€åœ¨è¿›ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹ï¼›å¦‚æœå‚æ•°<code>pid</code>å°äº 0ï¼Œåˆ™è¯¥å‡½æ•°å°†ä¿¡å·å‘é€ç»™è¿›ç¨‹ç»„ ID ä¸º<code>|pid|</code>çš„è¿›ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹ã€‚</p>
<h4 id="alarm">ä½¿ç”¨ alarm å‡½æ•°å‘é€ä¿¡å·<a class="headerlink" href="#alarm" title="Permanent link">&para;</a></h4>
<p>è¿›ç¨‹å¯ä»¥è°ƒç”¨<code>alarm</code>å‡½æ•°å‘è‡ªå·±å‘é€ SIGALRM ä¿¡å·ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span>
<span class="normal"><a href="#__codelineno-20-2">2</a></span>
<span class="normal"><a href="#__codelineno-20-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">alarm</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">secs</span><span class="p">);</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="c1">// Returns: remaining seconds of previous alarm, or 0 if no previous alarm</span>
</code></pre></div></td></tr></table></div>
<p>å†…æ ¸å°†åœ¨<code>secs</code>ç§’åå‘è°ƒç”¨è¿›ç¨‹å‘é€ SIGALRM ä¿¡å·ï¼Œå–æ¶ˆæ‰€æœ‰ä¹‹å‰è®¾ç½®çš„<code>alarm</code>ï¼Œå¹¶è¿”å›å…¶å‰©ä½™çš„ç§’æ•°ã€‚</p>
<h3 id="_28">æ¥æ”¶ä¿¡å·<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h3>
<p>å½“å†…æ ¸å°†è¿›ç¨‹ p ä»å†…æ ¸æ€åˆ‡æ¢åˆ°ç”¨æˆ·æ€æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥ p æœªé˜»å¡ä¸”æœªå¤„ç†ï¼ˆPending &amp; ~Blockedï¼‰çš„ä¿¡å·é›†ã€‚é€šå¸¸è¯¥é›†åˆä¸ºç©ºï¼Œå†…æ ¸å°†æ§åˆ¶æƒè½¬ç§»ç»™ p çš„é€»è¾‘æ§åˆ¶æµä¸­çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚ä½†å¦‚æœè¯¥é›†åˆéç©ºï¼Œå†…æ ¸å°±ä¼šé€‰æ‹©ä¿¡å·é›†ä¸­çš„æŸä¸ªä¿¡å· k å¹¶å¼ºåˆ¶ p æ¥æ”¶å®ƒã€‚ä¿¡å·å°†è§¦å‘è¿›ç¨‹å®Œæˆä¸€äº›åŠ¨ä½œï¼ˆActionï¼‰ï¼Œé¢„å®šä¹‰çš„é»˜è®¤åŠ¨ä½œæœ‰ï¼š</p>
<ul>
<li>è¿›ç¨‹ç»ˆæ­¢ï¼›</li>
<li>è¿›ç¨‹ç»ˆæ­¢å¹¶è½¬å‚¨æ ¸å¿ƒï¼ˆDump Coreï¼Œå³å°†ä»£ç å’Œæ•°æ®å†…å­˜æ®µçš„é•œåƒå†™å…¥ç£ç›˜ï¼‰ï¼›</li>
<li>è¿›ç¨‹åœæ­¢ï¼ˆæš‚åœï¼‰ï¼Œç›´åˆ°æ¥æ”¶ SIGCONT ä¿¡å·é‡æ–°å¯åŠ¨ï¼›</li>
<li>è¿›ç¨‹å¿½ç•¥è¯¥ä¿¡å·ã€‚</li>
</ul>
<p>æ¯ç§ä¿¡å·çš„é»˜è®¤åŠ¨ä½œè§ï¼ˆä¸Šå›¾ 8.26ï¼‰ã€‚é™¤ SIGSTOP å’Œ SIGKILL ä¿¡å·å¤–ï¼Œè¿›ç¨‹è¿˜å¯ä»¥é€šè¿‡å‡½æ•°<code>signal</code>ä¿®æ”¹ä¿¡å·çš„é»˜è®¤åŠ¨ä½œï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span>
<span class="normal"><a href="#__codelineno-21-2">2</a></span>
<span class="normal"><a href="#__codelineno-21-3">3</a></span>
<span class="normal"><a href="#__codelineno-21-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;signal.h&gt;</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="kt">sighandler_t</span><span class="p">)(</span><span class="kt">int</span><span class="p">);</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="kt">sighandler_t</span><span class="w"> </span><span class="nf">signal</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">signum</span><span class="p">,</span><span class="w"> </span><span class="kt">sighandler_t</span><span class="w"> </span><span class="n">handler</span><span class="p">);</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="c1">// Returns: pointer to previous handler if OK, SIG_ERR on error (does not set errno)</span>
</code></pre></div></td></tr></table></div>
<p>è‹¥å‚æ•°<code>handler</code>ä¸º<code>SIG_IGN</code>ï¼Œåˆ™<code>signum</code>ç±»å‹çš„ä¿¡å·å°†ä¼šè¢«å¿½ç•¥ï¼›è‹¥å‚æ•°<code>handler</code>ä¸º<code>SIG_DFL</code>ï¼Œåˆ™<code>signum</code>ç±»å‹çš„ä¿¡å·çš„åŠ¨ä½œå°†æ¢å¤ä¸ºé»˜è®¤ï¼›è‹¥å‚æ•°<code>handler</code>ä¸ºç”¨æˆ·å®šä¹‰çš„ä¿¡å·å¤„ç†ç¨‹åºåœ°å€ï¼Œåˆ™è¿›ç¨‹æ¥æ”¶åˆ°<code>signum</code>ç±»å‹çš„ä¿¡å·åä¼šè°ƒç”¨è¯¥ç¨‹åºï¼Œè¿™ç§æ–¹æ³•è¢«ç§°ä¸ºå®‰è£…å¤„ç†ç¨‹åºï¼ˆInstalling Handlerï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒç”¨å¤„ç†ç¨‹åºè¢«ç§°ä¸ºæ•è·ä¿¡å·ï¼ˆCatching Signalï¼‰ï¼Œæ‰§è¡Œå¤„ç†ç¨‹åºè¢«ç§°ä¸ºå¤„ç†ä¿¡å·ï¼ˆHandling Signalï¼‰ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬åœ¨ç¤ºä¾‹ç¨‹åºè¿è¡Œæ—¶æŒ‰ä¸‹ Ctrl+Cï¼Œè¯¥è¿›ç¨‹å°±ä¸ä¼šç›´æ¥ç»ˆæ­¢è€Œæ˜¯è¾“å‡ºä¸€æ®µä¿¡æ¯åæ‰ç»ˆæ­¢ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-22-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-22-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-22-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-22-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-22-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-22-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-22-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-22-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-22-10">10</a></span>
<span class="normal"><a href="#__codelineno-22-11">11</a></span>
<span class="normal"><a href="#__codelineno-22-12">12</a></span>
<span class="normal"><a href="#__codelineno-22-13">13</a></span>
<span class="normal"><a href="#__codelineno-22-14">14</a></span>
<span class="normal"><a href="#__codelineno-22-15">15</a></span>
<span class="normal"><a href="#__codelineno-22-16">16</a></span>
<span class="normal"><a href="#__codelineno-22-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;csapp.h&quot;</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="kt">void</span><span class="w"> </span><span class="nf">handler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">sig</span><span class="p">)</span><span class="w"> </span><span class="cm">/* SIGINT handler */</span>
<a id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="p">{</span>
<a id="__codelineno-22-5" name="__codelineno-22-5"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Caught SIGINT</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<a id="__codelineno-22-6" name="__codelineno-22-6"></a><span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-22-7" name="__codelineno-22-7"></a><span class="p">}</span>
<a id="__codelineno-22-8" name="__codelineno-22-8"></a>
<a id="__codelineno-22-9" name="__codelineno-22-9"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<a id="__codelineno-22-10" name="__codelineno-22-10"></a><span class="p">{</span>
<a id="__codelineno-22-11" name="__codelineno-22-11"></a><span class="w">    </span><span class="cm">/* Install the SIGINT handler */</span>
<a id="__codelineno-22-12" name="__codelineno-22-12"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">signal</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">,</span><span class="w"> </span><span class="n">handler</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">SIG_ERR</span><span class="p">)</span>
<a id="__codelineno-22-13" name="__codelineno-22-13"></a><span class="w">        </span><span class="n">unix_error</span><span class="p">(</span><span class="s">&quot;signal error&quot;</span><span class="p">);</span>
<a id="__codelineno-22-14" name="__codelineno-22-14"></a>
<a id="__codelineno-22-15" name="__codelineno-22-15"></a><span class="w">    </span><span class="n">Pause</span><span class="p">();</span><span class="w"> </span><span class="cm">/* Wait for the receipt of a signal */</span>
<a id="__codelineno-22-16" name="__codelineno-22-16"></a><span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-22-17" name="__codelineno-22-17"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>ä¿¡å·å¤„ç†ç¨‹åºè¿˜å¯ä»¥è¢«å…¶ä»–å¤„ç†ç¨‹åºä¸­æ–­ï¼ˆä¿¡å· <span class="arithmatex">\(s \ne t\)</span>ï¼‰ï¼š</p>
<p><img alt="alt text" src="../image/image-106.png" /></p>
<h3 id="_29">é˜»å¡ä¿¡å·<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h3>
<p>Linux ä¸ºé˜»å¡ä¿¡å·æä¾›äº†æ˜¾å¼å’Œéšå¼çš„å®ç°æœºåˆ¶ï¼š</p>
<ul>
<li>éšå¼ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œå†…æ ¸ä¼šé˜»å¡ä»»ä½•ä¸å¤„ç†ç¨‹åºå½“å‰æ­£åœ¨å¤„ç†çš„ä¿¡å·ç±»å‹ç›¸åŒçš„æœªå¤„ç†ä¿¡å·ã€‚æ¯”å¦‚ä¸Šå›¾ 8.31 ä¸­ï¼Œè‹¥ä¿¡å· <span class="arithmatex">\(t\)</span> çš„ç±»å‹ä¸ <span class="arithmatex">\(s\)</span> ç›¸åŒï¼Œåˆ™ <span class="arithmatex">\(t\)</span> å°†åœ¨å¤„ç†ç¨‹åº <span class="arithmatex">\(S\)</span> è¿”å›å‰æŒç»­æŒ‚èµ·ï¼›</li>
<li>æ˜¾å¼ï¼šåº”ç”¨ç¨‹åºå¯ä»¥è°ƒç”¨<code>sigprocmask</code>ç­‰å‡½æ•°é˜»å¡ä¿¡å·æˆ–è§£é™¤ä¿¡å·çš„é˜»å¡ã€‚</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;signal.h&gt;</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="kt">int</span><span class="w"> </span><span class="nf">sigprocmask</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">how</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">sigset_t</span><span class="w"> </span><span class="o">*</span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="kt">sigset_t</span><span class="w"> </span><span class="o">*</span><span class="n">oldset</span><span class="p">);</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="kt">int</span><span class="w"> </span><span class="nf">sigemptyset</span><span class="p">(</span><span class="kt">sigset_t</span><span class="w"> </span><span class="o">*</span><span class="n">set</span><span class="p">);</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="kt">int</span><span class="w"> </span><span class="nf">sigfillset</span><span class="p">(</span><span class="kt">sigset_t</span><span class="w"> </span><span class="o">*</span><span class="n">set</span><span class="p">);</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="kt">int</span><span class="w"> </span><span class="nf">sigaddset</span><span class="p">(</span><span class="kt">sigset_t</span><span class="w"> </span><span class="o">*</span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">signum</span><span class="p">);</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="kt">int</span><span class="w"> </span><span class="nf">sigdelset</span><span class="p">(</span><span class="kt">sigset_t</span><span class="w"> </span><span class="o">*</span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">signum</span><span class="p">);</span>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="c1">// Returns: 0 if OK, âˆ’1 on error</span>
<a id="__codelineno-23-8" name="__codelineno-23-8"></a>
<a id="__codelineno-23-9" name="__codelineno-23-9"></a><span class="kt">int</span><span class="w"> </span><span class="nf">sigismember</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">sigset_t</span><span class="w"> </span><span class="o">*</span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">signum</span><span class="p">);</span>
<a id="__codelineno-23-10" name="__codelineno-23-10"></a><span class="c1">// Returns: 1 if member, 0 if not, âˆ’1 on error</span>
</code></pre></div></td></tr></table></div>
<p><code>sigprocmask</code>å‡½æ•°å¯ä»¥æ”¹å˜å½“å‰é˜»å¡ä¿¡å·çš„é›†åˆï¼ˆè®¾ä¸º<code>blocked</code>ï¼‰ï¼Œå…·ä½“è¡Œä¸ºå–å†³äºå‚æ•°<code>how</code>çš„å€¼ï¼š</p>
<ul>
<li><code>SIG_BLOCK</code>ï¼šå°†å‚æ•°<code>set</code>ä¸­çš„ä¿¡å·é˜»å¡ï¼ˆ<code>blocked = blocked | set</code>ï¼‰ï¼›</li>
<li><code>SIG_UNBLOCK</code>ï¼šä¸º<code>set</code>ä¸­çš„ä¿¡å·è§£é™¤é˜»å¡ï¼ˆ<code>blocked = blocked &amp; ~set</code>ï¼‰ï¼›</li>
<li><code>SIG_SETMASK</code>ï¼šå°†é˜»å¡ä¿¡å·é›†åˆè®¾ä¸º<code>set</code>ï¼ˆ<code>blocked = set</code>ï¼‰ã€‚</li>
</ul>
<p>å¦‚æœå‚æ•°<code>oldset</code>éç©ºï¼Œåˆ™å…ˆå‰<code>blocked</code>çš„å€¼ä¼šå­˜å‚¨åœ¨<code>oldset</code>ä¸­ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œå‡½æ•°<code>sigemptyset</code>å°†<code>set</code>åˆå§‹åŒ–ä¸ºç©ºé›†ï¼›<code>sigfillset</code>å°†æ‰€æœ‰ä¿¡å·åŠ å…¥åˆ°<code>set</code>ä¸­ï¼›<code>sigaddset</code>å°†ç¼–å·ä¸º<code>signum</code>çš„ä¿¡å·åŠ å…¥åˆ°<code>set</code>ä¸­ï¼›<code>sigdelset</code>å°†ç¼–å·ä¸º<code>signum</code>çš„ä¿¡å·ä»<code>set</code>ä¸­åˆ é™¤ï¼›å¦‚æœ<code>signum</code>ä¿¡å·åœ¨<code>set</code>ä¸­ï¼Œåˆ™å‡½æ•°<code>sigismember</code>è¿”å› 1ï¼Œå¦åˆ™è¿”å› 0ã€‚</p>
<p>ç¤ºä¾‹ç¨‹åºæš‚æ—¶é˜»å¡äº† SIGINT ä¿¡å·çš„æ¥æ”¶ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="kt">sigset_t</span><span class="w"> </span><span class="n">mask</span><span class="p">,</span><span class="w"> </span><span class="n">prev_mask</span><span class="p">;</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="n">sigemptyset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mask</span><span class="p">);</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="n">sigaddset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mask</span><span class="p">,</span><span class="w"> </span><span class="n">SIGINT</span><span class="p">);</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="cm">/* Block SIGINT and save previous blocked set */</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="n">sigprocmask</span><span class="p">(</span><span class="n">SIG_BLOCK</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mask</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">prev_mask</span><span class="p">);</span>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a><span class="c1">// Code region that will not be interrupted by SIGINT</span>
<a id="__codelineno-24-8" name="__codelineno-24-8"></a>
<a id="__codelineno-24-9" name="__codelineno-24-9"></a><span class="cm">/* Restore previous blocked set, unblocking SIGINT */</span>
<a id="__codelineno-24-10" name="__codelineno-24-10"></a><span class="n">sigprocmask</span><span class="p">(</span><span class="n">SIG_SETMASK</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">prev_mask</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<h3 id="_30">ç¼–å†™ä¿¡å·å¤„ç†ç¨‹åº<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h3>
<h4 id="_31">å®‰å…¨çš„ä¿¡å·å¤„ç†<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h4>
<p>å¦‚æœå¤„ç†ç¨‹åºå’Œä¸»ç¨‹åºå¹¶å‘åœ°è®¿é—®åŒä¸€ä¸ªå…¨å±€æ•°æ®ç»“æ„ï¼Œå°±ä¼šå‘ç”Ÿä¸å¯é¢„çŸ¥çš„ä¸¥é‡é—®é¢˜ã€‚å› æ­¤æˆ‘ä»¬åœ¨ç¼–å†™ä¿¡å·å¤„ç†ç¨‹åºæ—¶åº”å½“éµå¾ªä»¥ä¸‹å®ˆåˆ™ï¼š</p>
<ul>
<li>ä½¿ä¿¡å·å¤„ç†ç¨‹åºå°½å¯èƒ½çš„ç®€å•ï¼›</li>
<li>ä»…è°ƒç”¨å¼‚æ­¥ä¿¡å·å®‰å…¨ï¼ˆAsync-Signal-Safeï¼‰çš„å‡½æ•°ã€‚è¿™ç§å‡½æ•°ä¸€èˆ¬åªè®¿é—®å±€éƒ¨å˜é‡ï¼Œæˆ–è€…ä¸ä¼šè¢«å…¶ä»–ä¿¡å·å¤„ç†ç¨‹åºä¸­æ–­ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè®¸å¤šå¸¸ç”¨çš„å‡½æ•°ï¼Œå¦‚<code>printf</code>ã€<code>sprintf</code>ã€<code>malloc</code>å’Œ<code>exit</code>ç­‰å¹¶éå¼‚æ­¥ä¿¡å·å®‰å…¨ã€‚è°ƒç”¨<code>write</code>å‡½æ•°æ˜¯ä¿¡å·å¤„ç†ç¨‹åºç”Ÿæˆè¾“å‡ºçš„å”¯ä¸€å®‰å…¨æ–¹æ³•ï¼›</li>
<li>ä¿å­˜å¹¶æ¢å¤å˜é‡<code>errno</code>ï¼šè®¸å¤š Linux å¼‚æ­¥ä¿¡å·å®‰å…¨å‡½æ•°è¿”å›é”™è¯¯æ—¶ä¼šè®¾ç½®å˜é‡<code>errno</code>çš„å€¼ï¼Œå› æ­¤å¯èƒ½ä¼šå¹²æ‰°ç¨‹åºä¸­å…¶ä»–ä¾èµ–<code>errno</code>çš„éƒ¨åˆ†ã€‚å½“å¤„ç†ç¨‹åºæœ‰è¿”å›æ—¶ï¼Œæˆ‘ä»¬åº”å½“åœ¨è°ƒç”¨å‰å°†<code>errno</code>ä¿å­˜åˆ°å±€éƒ¨å˜é‡ä¸­ï¼Œå¹¶åœ¨è¿”å›å‰æ¢å¤å…¶å€¼ï¼›</li>
<li>è®¿é—®å…¨å±€æ•°æ®ç»“æ„æ—¶é˜»å¡æ‰€æœ‰ä¿¡å·ï¼›</li>
<li>å‡è®¾ä¸»ç¨‹åºå’Œä¿¡å·å¤„ç†ç¨‹åºå…±äº«å…¨å±€å˜é‡<code>g</code>ï¼Œå¤„ç†ç¨‹åºæ›´æ–°<code>g</code>çš„å€¼ï¼Œä¸»ç¨‹åºå®šæœŸè¯»å–<code>g</code>çš„å€¼ã€‚ä¼˜åŒ–çš„ç¼–è¯‘å™¨ä¼šä»å¯„å­˜å™¨ä¸­è¯»å–å·²ç¼“å­˜çš„<code>g</code>ï¼Œå› æ­¤ä¸»å‡½æ•°ä¸­çš„<code>g</code>å¯èƒ½æ°¸è¿œä¸å˜ï¼Œå¹¶ä¸”æ¯æ¬¡å¯¹<code>g</code>çš„å¼•ç”¨ä¹Ÿéƒ½æ˜¯å®‰å…¨çš„ã€‚è‹¥ä½¿ç”¨<code>volatile</code>å£°æ˜å…¨å±€å˜é‡ï¼Œå¦‚<code>volatile int g;</code>ï¼Œé‚£ä¹ˆå½“ä»£ç å¼•ç”¨<code>g</code>æ—¶ï¼Œç¼–è¯‘å™¨å°±ä¼šä»å†…å­˜ä¸­è¯»å–å…¶å€¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”å½“ä¸´æ—¶é˜»å¡ä¿¡å·ä»¥ä¿æŠ¤å¯¹<code>g</code>çš„è®¿é—®ï¼›</li>
<li>åœ¨å¸¸è§çš„è®¾è®¡ä¸­ï¼Œå¤„ç†ç¨‹åºé€šè¿‡å†™å…¥å…¨å±€æ ‡è¯†ï¼ˆFlagï¼‰æ¥è®°å½•ä¿¡å·çš„æ¥æ”¶ã€‚è‹¥ä½¿ç”¨<code>sig_atomic_t</code>ç±»å‹å£°æ˜æ ‡è¯†ï¼Œå¦‚<code>volatile sig_atomic_t flag;</code>ï¼Œé‚£ä¹ˆä¾¿å¯ä»¥ä¿è¯<code>flag</code>å†™å…¥çš„åŸå­æ€§ï¼ˆAtomic/Uninterruptibleï¼‰ã€‚</li>
</ul>
<h4 id="_32">æ­£ç¡®çš„ä¿¡å·å¤„ç†<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h4>
<p>ä¸Šæ–‡æåˆ°ï¼Œçˆ¶è¿›ç¨‹å¿…é¡»å›æ”¶å­è¿›ç¨‹ä»¥é¿å…åœ¨ç³»ç»Ÿä¸­ç•™ä¸‹åƒµå°¸è¿›ç¨‹ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¸Œæœ›çˆ¶è¿›ç¨‹å¯ä»¥åœ¨å­è¿›ç¨‹è¿è¡Œæ—¶è‡ªç”±åœ°æ‰§è¡Œå…¶ä»–ä»»åŠ¡ã€‚å› æ­¤æˆ‘ä»¬ä½¿ç”¨ SIGCHILD å¤„ç†ç¨‹åºæ¥å›æ”¶å­è¿›ç¨‹ï¼Œè€Œä¸æ˜¯æ˜¾å¼åœ°è°ƒç”¨<code>waitpid</code>ç­‰å¾…å­è¿›ç¨‹ç»ˆæ­¢ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-25-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-25-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-25-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-25-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-25-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-25-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-25-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-25-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-25-10">10</a></span>
<span class="normal"><a href="#__codelineno-25-11">11</a></span>
<span class="normal"><a href="#__codelineno-25-12">12</a></span>
<span class="normal"><a href="#__codelineno-25-13">13</a></span>
<span class="normal"><a href="#__codelineno-25-14">14</a></span>
<span class="normal"><a href="#__codelineno-25-15">15</a></span>
<span class="normal"><a href="#__codelineno-25-16">16</a></span>
<span class="normal"><a href="#__codelineno-25-17">17</a></span>
<span class="normal"><a href="#__codelineno-25-18">18</a></span>
<span class="normal"><a href="#__codelineno-25-19">19</a></span>
<span class="normal"><a href="#__codelineno-25-20">20</a></span>
<span class="normal"><a href="#__codelineno-25-21">21</a></span>
<span class="normal"><a href="#__codelineno-25-22">22</a></span>
<span class="normal"><a href="#__codelineno-25-23">23</a></span>
<span class="normal"><a href="#__codelineno-25-24">24</a></span>
<span class="normal"><a href="#__codelineno-25-25">25</a></span>
<span class="normal"><a href="#__codelineno-25-26">26</a></span>
<span class="normal"><a href="#__codelineno-25-27">27</a></span>
<span class="normal"><a href="#__codelineno-25-28">28</a></span>
<span class="normal"><a href="#__codelineno-25-29">29</a></span>
<span class="normal"><a href="#__codelineno-25-30">30</a></span>
<span class="normal"><a href="#__codelineno-25-31">31</a></span>
<span class="normal"><a href="#__codelineno-25-32">32</a></span>
<span class="normal"><a href="#__codelineno-25-33">33</a></span>
<span class="normal"><a href="#__codelineno-25-34">34</a></span>
<span class="normal"><a href="#__codelineno-25-35">35</a></span>
<span class="normal"><a href="#__codelineno-25-36">36</a></span>
<span class="normal"><a href="#__codelineno-25-37">37</a></span>
<span class="normal"><a href="#__codelineno-25-38">38</a></span>
<span class="normal"><a href="#__codelineno-25-39">39</a></span>
<span class="normal"><a href="#__codelineno-25-40">40</a></span>
<span class="normal"><a href="#__codelineno-25-41">41</a></span>
<span class="normal"><a href="#__codelineno-25-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;csapp.h&quot;</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="kt">void</span><span class="w"> </span><span class="nf">handler1</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">sig</span><span class="p">)</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="p">{</span>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a><span class="w">    </span><span class="kt">pid_t</span><span class="w"> </span><span class="n">pid</span><span class="p">;</span>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">waitpid</span><span class="p">(</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-25-8" name="__codelineno-25-8"></a><span class="w">        </span><span class="n">unix_error</span><span class="p">(</span><span class="s">&quot;waitpid error&quot;</span><span class="p">);</span>
<a id="__codelineno-25-9" name="__codelineno-25-9"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Handler reaped child %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">pid</span><span class="p">);</span>
<a id="__codelineno-25-10" name="__codelineno-25-10"></a><span class="w">    </span><span class="n">Sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<a id="__codelineno-25-11" name="__codelineno-25-11"></a><span class="w">    </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-25-12" name="__codelineno-25-12"></a><span class="p">}</span>
<a id="__codelineno-25-13" name="__codelineno-25-13"></a>
<a id="__codelineno-25-14" name="__codelineno-25-14"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<a id="__codelineno-25-15" name="__codelineno-25-15"></a><span class="p">{</span>
<a id="__codelineno-25-16" name="__codelineno-25-16"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<a id="__codelineno-25-17" name="__codelineno-25-17"></a><span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">buf</span><span class="p">[</span><span class="n">MAXBUF</span><span class="p">];</span>
<a id="__codelineno-25-18" name="__codelineno-25-18"></a>
<a id="__codelineno-25-19" name="__codelineno-25-19"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">signal</span><span class="p">(</span><span class="n">SIGCHLD</span><span class="p">,</span><span class="w"> </span><span class="n">handler1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">SIG_ERR</span><span class="p">)</span>
<a id="__codelineno-25-20" name="__codelineno-25-20"></a><span class="w">        </span><span class="n">unix_error</span><span class="p">(</span><span class="s">&quot;signal error&quot;</span><span class="p">);</span>
<a id="__codelineno-25-21" name="__codelineno-25-21"></a>
<a id="__codelineno-25-22" name="__codelineno-25-22"></a><span class="w">    </span><span class="cm">/* Parent creates children */</span>
<a id="__codelineno-25-23" name="__codelineno-25-23"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<a id="__codelineno-25-24" name="__codelineno-25-24"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-25-25" name="__codelineno-25-25"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Fork</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-25-26" name="__codelineno-25-26"></a><span class="w">        </span><span class="p">{</span>
<a id="__codelineno-25-27" name="__codelineno-25-27"></a><span class="w">            </span><span class="n">fprintf</span><span class="p">(</span><span class="s">&quot;Hello from child %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">getpid</span><span class="p">());</span>
<a id="__codelineno-25-28" name="__codelineno-25-28"></a><span class="w">            </span><span class="n">Sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-25-29" name="__codelineno-25-29"></a><span class="w">            </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-25-30" name="__codelineno-25-30"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-25-31" name="__codelineno-25-31"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-25-32" name="__codelineno-25-32"></a>
<a id="__codelineno-25-33" name="__codelineno-25-33"></a><span class="w">    </span><span class="cm">/* Parent waits for terminal input and then processes it */</span>
<a id="__codelineno-25-34" name="__codelineno-25-34"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read</span><span class="p">(</span><span class="n">STDIN_FILENO</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">)))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-25-35" name="__codelineno-25-35"></a><span class="w">        </span><span class="n">unix_error</span><span class="p">(</span><span class="s">&quot;read&quot;</span><span class="p">);</span>
<a id="__codelineno-25-36" name="__codelineno-25-36"></a>
<a id="__codelineno-25-37" name="__codelineno-25-37"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Parent processing input</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<a id="__codelineno-25-38" name="__codelineno-25-38"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-25-39" name="__codelineno-25-39"></a><span class="w">        </span><span class="p">;</span>
<a id="__codelineno-25-40" name="__codelineno-25-40"></a>
<a id="__codelineno-25-41" name="__codelineno-25-41"></a><span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-25-42" name="__codelineno-25-42"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>ç¤ºä¾‹ç¨‹åºä¸­ï¼Œçˆ¶è¿›ç¨‹å®‰è£…äº†å¤„ç†ç¨‹åº<code>handler1</code>å¹¶åˆ›å»ºä¸‰ä¸ªå­è¿›ç¨‹ã€‚å®ƒç­‰å¾…æ¥è‡ªç»ˆç«¯çš„è¾“å…¥ï¼Œç„¶åè¿›å…¥ While å¾ªç¯ã€‚æ¯å½“ä¸€ä¸ªå­è¿›ç¨‹ç»ˆæ­¢æ—¶ï¼Œå†…æ ¸å°†å‘é€ä¸€ä¸ª SIGCHLD ä¿¡å·é€šçŸ¥çˆ¶è¿›ç¨‹ã€‚çˆ¶è¿›ç¨‹æ•è·ä¿¡å·åå›æ”¶å­è¿›ç¨‹ï¼Œè¾“å‡ºä¸€æ®µä¿¡æ¯ç„¶åè¿”å›ã€‚</p>
<p>åœ¨ Linux ä¸Šè¿è¡Œè¯¥ç¨‹åºå¾—åˆ°çš„è¾“å‡ºç»“æœä¸ºï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span>
<span class="normal"><a href="#__codelineno-26-2">2</a></span>
<span class="normal"><a href="#__codelineno-26-3">3</a></span>
<span class="normal"><a href="#__codelineno-26-4">4</a></span>
<span class="normal"><a href="#__codelineno-26-5">5</a></span>
<span class="normal"><a href="#__codelineno-26-6">6</a></span>
<span class="normal"><a href="#__codelineno-26-7">7</a></span>
<span class="normal"><a href="#__codelineno-26-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="n">linux</span><span class="o">&gt;</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">signal1</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="n">Hello</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="mi">14073</span><span class="w"> </span>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="n">Hello</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="mi">14074</span><span class="w"> </span>
<a id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="n">Hello</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="mi">14075</span><span class="w"> </span>
<a id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="n">Handler</span><span class="w"> </span><span class="n">reaped</span><span class="w"> </span><span class="n">child</span><span class="w"> </span>
<a id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="n">Handler</span><span class="w"> </span><span class="n">reaped</span><span class="w"> </span><span class="n">child</span>
<a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="n">CR</span>
<a id="__codelineno-26-8" name="__codelineno-26-8"></a><span class="n">Parent</span><span class="w"> </span><span class="n">processing</span><span class="w"> </span><span class="n">input</span>
</code></pre></div></td></tr></table></div>
<p>çˆ¶è¿›ç¨‹åˆ›å»ºäº†ä¸‰ä¸ªå­è¿›ç¨‹ï¼Œç„¶è€Œå´åªå›æ”¶äº†ä¸¤ä¸ªï¼Œè¿™æ˜¯å› ä¸ºåŒä¸€æ—¶é—´å†…ç›¸åŒç±»å‹çš„æœªå¤„ç†ä¿¡å·æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªã€‚ä¿¡å·å¤„ç†ç¨‹åºåœ¨å¤„ç†ç¬¬ä¸€ä¸ªä¿¡å·æ—¶ï¼Œç¬¬äºŒä¸ªä¿¡å·åˆ°è¾¾å¹¶è¢«æ·»åŠ åˆ°æœªå¤„ç†ä¿¡å·é›†ä¸­ã€‚ç”±äºå·²æœ‰ä¸€ä¸ªæœªå¤„ç†çš„ SIGCHLD ä¿¡å·ï¼Œæ­¤æ—¶è‹¥ç¬¬ä¸‰ä¸ªä¿¡å·åˆ°è¾¾ä¾¿ä¼šè¢«ç›´æ¥ä¸¢å¼ƒã€‚å½“å¤„ç†ç¨‹åºè¿”å›åï¼Œå†…æ ¸å‘ç°ç¬¬äºŒä¸ªä¿¡å·è¿˜æœªå¤„ç†ï¼Œäºæ˜¯å¼ºåˆ¶çˆ¶è¿›ç¨‹æ¥æ”¶è¯¥ä¿¡å·å¹¶é‡æ–°æ‰§è¡Œå¤„ç†ç¨‹åºã€‚ç­‰åˆ°å¤„ç†ç¨‹åºå†æ¬¡è¿”å›ï¼Œçˆ¶è¿›ç¨‹å°±ä¸å†æœ‰ä»»ä½•æœªå¤„ç†çš„ SIGCHLD ä¿¡å·äº†ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥è®©å¤„ç†ç¨‹åºåœ¨è¢«è°ƒç”¨æ—¶å°½å¯èƒ½å¤šåœ°å›æ”¶å­è¿›ç¨‹ä»¥è§£å†³è¿™ä¸€é—®é¢˜ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-27-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-27-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-27-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-27-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-27-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-27-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-27-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-27-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-27-10">10</a></span>
<span class="normal"><a href="#__codelineno-27-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">handler2</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">sig</span><span class="p">)</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="p">{</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="w">    </span><span class="kt">pid_t</span><span class="w"> </span><span class="n">pid</span><span class="p">;</span>
<a id="__codelineno-27-4" name="__codelineno-27-4"></a>
<a id="__codelineno-27-5" name="__codelineno-27-5"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">waitpid</span><span class="p">(</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">WNOHANG</span><span class="p">))</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-27-6" name="__codelineno-27-6"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Handler reaped child %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">pid</span><span class="p">);</span>
<a id="__codelineno-27-7" name="__codelineno-27-7"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">errno</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ECHILD</span><span class="p">)</span>
<a id="__codelineno-27-8" name="__codelineno-27-8"></a><span class="w">        </span><span class="n">unix_error</span><span class="p">(</span><span class="s">&quot;waitpid error&quot;</span><span class="p">);</span>
<a id="__codelineno-27-9" name="__codelineno-27-9"></a><span class="w">    </span><span class="n">Sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<a id="__codelineno-27-10" name="__codelineno-27-10"></a><span class="w">    </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-27-11" name="__codelineno-27-11"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="_33">å¯ç§»æ¤çš„ä¿¡å·å¤„ç†<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h4>
<p>ä¸åŒçš„ç³»ç»Ÿæœ‰ç€ä¸åŒçš„ä¿¡å·å¤„ç†è¯­ä¹‰ï¼Œå› æ­¤ Posix æ ‡å‡†å®šä¹‰äº†<code>sigaction</code>å‡½æ•°ï¼Œå®ƒå…è®¸ç”¨æˆ·åœ¨å®‰è£…ä¿¡å·å¤„ç†ç¨‹åºæ—¶æ˜ç¡®åœ°æŒ‡å®šä»–ä»¬æƒ³è¦çš„è¯­ä¹‰ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span>
<span class="normal"><a href="#__codelineno-28-2">2</a></span>
<span class="normal"><a href="#__codelineno-28-3">3</a></span>
<span class="normal"><a href="#__codelineno-28-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;signal.h&gt;</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="kt">int</span><span class="w"> </span><span class="nf">sigaction</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">signum</span><span class="p">,</span><span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">sigaction</span><span class="w"> </span><span class="o">*</span><span class="n">act</span><span class="p">,</span>
<a id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="w">              </span><span class="k">struct</span><span class="w"> </span><span class="nc">sigaction</span><span class="w"> </span><span class="o">*</span><span class="n">oldact</span><span class="p">);</span>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="c1">// Returns: 0 if OK, âˆ’1 on error</span>
</code></pre></div></td></tr></table></div>
<p>ç„¶è€Œ<code>sigaction</code>å‡½æ•°ååˆ†ç¬¨é‡ï¼Œå› æ­¤æˆ‘ä»¬å¸¸ä½¿ç”¨å®ƒçš„åŒ…è£…å‡½æ•°<code>Signal</code>ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-29-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-29-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-29-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-29-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-29-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-29-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-29-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-29-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-29-10">10</a></span>
<span class="normal"><a href="#__codelineno-29-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="n">handler_t</span><span class="w"> </span><span class="o">*</span><span class="nf">Signal</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">signum</span><span class="p">,</span><span class="w"> </span><span class="n">handler_t</span><span class="w"> </span><span class="o">*</span><span class="n">handler</span><span class="p">)</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="p">{</span>
<a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">sigaction</span><span class="w"> </span><span class="n">action</span><span class="p">,</span><span class="w"> </span><span class="n">old_action</span><span class="p">;</span>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="w">    </span><span class="n">action</span><span class="p">.</span><span class="n">sa_handler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">handler</span><span class="p">;</span>
<a id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="w">    </span><span class="n">sigemptyset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">action</span><span class="p">.</span><span class="n">sa_mask</span><span class="p">);</span><span class="w"> </span><span class="cm">/* Block sigs of type being handled */</span>
<a id="__codelineno-29-6" name="__codelineno-29-6"></a><span class="w">    </span><span class="n">action</span><span class="p">.</span><span class="n">sa_flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA_RESTART</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Restart syscalls if possible */</span>
<a id="__codelineno-29-7" name="__codelineno-29-7"></a>
<a id="__codelineno-29-8" name="__codelineno-29-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sigaction</span><span class="p">(</span><span class="n">signum</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">action</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">old_action</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-29-9" name="__codelineno-29-9"></a><span class="w">        </span><span class="n">unix_error</span><span class="p">(</span><span class="s">&quot;Signal error&quot;</span><span class="p">);</span>
<a id="__codelineno-29-10" name="__codelineno-29-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">old_action</span><span class="p">.</span><span class="n">sa_handler</span><span class="p">);</span>
<a id="__codelineno-29-11" name="__codelineno-29-11"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="_34">é¿å…å¹¶å‘é”™è¯¯<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h3>
<p>ä¸Šæ–‡æåˆ°ï¼Œæˆ‘ä»¬æ°¸è¿œæ— æ³•é¢„æµ‹ä¸¤ä¸ªåŒæ­¥ï¼ˆå¹¶å‘ï¼‰è¿è¡Œçš„å‡½æ•°çš„è°ƒç”¨é¡ºåºã€‚å¦‚æœè°ƒç”¨é¡ºåºä¼šå½±å“ç»“æœçš„æ­£ç¡®æ€§ï¼Œé‚£ä¹ˆè¿™ç§é”™è¯¯å°±è¢«ç§°ä¸ºç«äº‰ï¼ˆRaceï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡é˜»å¡ç›¸å…³ä¿¡å·æ¥é¿å…è¿™ä¸€é—®é¢˜ã€‚</p>
<h3 id="_35">æ˜¾å¼ç­‰å¾…ä¿¡å·<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h3>
<p>æœ‰æ—¶å€™ä¸»ç¨‹åºéœ€è¦æ˜¾å¼ç­‰å¾…æŸä¸ªä¿¡å·å¤„ç†ç¨‹åºè¿è¡Œå®Œæ¯•ã€‚ä¾‹å¦‚ Linux Shell åˆ›å»ºå‰å°ä»»åŠ¡åï¼Œå¿…é¡»ç­‰å¾…ä»»åŠ¡ç»ˆæ­¢å¹¶è¢« SIGCHLD å¤„ç†ç¨‹åºå›æ”¶ï¼Œç„¶åæ‰èƒ½æ¥æ”¶ä¸‹ä¸€æ¡ç”¨æˆ·å‘½ä»¤ã€‚ç¤ºä¾‹ç¨‹åºå±•ç¤ºäº†å…¶åŸºæœ¬æ€æƒ³ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-30-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-30-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-30-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-30-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-30-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-30-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-30-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-30-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-30-10">10</a></span>
<span class="normal"><a href="#__codelineno-30-11">11</a></span>
<span class="normal"><a href="#__codelineno-30-12">12</a></span>
<span class="normal"><a href="#__codelineno-30-13">13</a></span>
<span class="normal"><a href="#__codelineno-30-14">14</a></span>
<span class="normal"><a href="#__codelineno-30-15">15</a></span>
<span class="normal"><a href="#__codelineno-30-16">16</a></span>
<span class="normal"><a href="#__codelineno-30-17">17</a></span>
<span class="normal"><a href="#__codelineno-30-18">18</a></span>
<span class="normal"><a href="#__codelineno-30-19">19</a></span>
<span class="normal"><a href="#__codelineno-30-20">20</a></span>
<span class="normal"><a href="#__codelineno-30-21">21</a></span>
<span class="normal"><a href="#__codelineno-30-22">22</a></span>
<span class="normal"><a href="#__codelineno-30-23">23</a></span>
<span class="normal"><a href="#__codelineno-30-24">24</a></span>
<span class="normal"><a href="#__codelineno-30-25">25</a></span>
<span class="normal"><a href="#__codelineno-30-26">26</a></span>
<span class="normal"><a href="#__codelineno-30-27">27</a></span>
<span class="normal"><a href="#__codelineno-30-28">28</a></span>
<span class="normal"><a href="#__codelineno-30-29">29</a></span>
<span class="normal"><a href="#__codelineno-30-30">30</a></span>
<span class="normal"><a href="#__codelineno-30-31">31</a></span>
<span class="normal"><a href="#__codelineno-30-32">32</a></span>
<span class="normal"><a href="#__codelineno-30-33">33</a></span>
<span class="normal"><a href="#__codelineno-30-34">34</a></span>
<span class="normal"><a href="#__codelineno-30-35">35</a></span>
<span class="normal"><a href="#__codelineno-30-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;csapp.h&quot;</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a>
<a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="k">volatile</span><span class="w"> </span><span class="kt">sig_atomic_t</span><span class="w"> </span><span class="n">pid</span><span class="p">;</span>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a>
<a id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="kt">void</span><span class="w"> </span><span class="nf">sigchld_handler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">s</span><span class="p">)</span>
<a id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="p">{</span>
<a id="__codelineno-30-7" name="__codelineno-30-7"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">olderrno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errno</span><span class="p">;</span>
<a id="__codelineno-30-8" name="__codelineno-30-8"></a><span class="w">    </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">waitpid</span><span class="p">(</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-30-9" name="__codelineno-30-9"></a><span class="w">    </span><span class="n">errno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">olderrno</span><span class="p">;</span>
<a id="__codelineno-30-10" name="__codelineno-30-10"></a><span class="p">}</span>
<a id="__codelineno-30-11" name="__codelineno-30-11"></a><span class="kt">void</span><span class="w"> </span><span class="nf">sigint_handler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">s</span><span class="p">)</span>
<a id="__codelineno-30-12" name="__codelineno-30-12"></a><span class="p">{</span>
<a id="__codelineno-30-13" name="__codelineno-30-13"></a><span class="p">}</span>
<a id="__codelineno-30-14" name="__codelineno-30-14"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<a id="__codelineno-30-15" name="__codelineno-30-15"></a><span class="p">{</span>
<a id="__codelineno-30-16" name="__codelineno-30-16"></a><span class="w">    </span><span class="kt">sigset_t</span><span class="w"> </span><span class="n">mask</span><span class="p">,</span><span class="w"> </span><span class="n">prev</span><span class="p">;</span>
<a id="__codelineno-30-17" name="__codelineno-30-17"></a><span class="w">    </span><span class="n">Signal</span><span class="p">(</span><span class="n">SIGCHLD</span><span class="p">,</span><span class="w"> </span><span class="n">sigchld_handler</span><span class="p">);</span>
<a id="__codelineno-30-18" name="__codelineno-30-18"></a><span class="w">    </span><span class="n">Signal</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">,</span><span class="w"> </span><span class="n">sigint_handler</span><span class="p">);</span>
<a id="__codelineno-30-19" name="__codelineno-30-19"></a><span class="w">    </span><span class="n">Sigemptyset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mask</span><span class="p">);</span>
<a id="__codelineno-30-20" name="__codelineno-30-20"></a><span class="w">    </span><span class="n">Sigaddset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mask</span><span class="p">,</span><span class="w"> </span><span class="n">SIGCHLD</span><span class="p">);</span>
<a id="__codelineno-30-21" name="__codelineno-30-21"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-30-22" name="__codelineno-30-22"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-30-23" name="__codelineno-30-23"></a><span class="w">        </span><span class="n">Sigprocmask</span><span class="p">(</span><span class="n">SIG_BLOCK</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mask</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">prev</span><span class="p">);</span><span class="w"> </span><span class="cm">/* Block SIGCHLD */</span>
<a id="__codelineno-30-24" name="__codelineno-30-24"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Fork</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">                      </span><span class="cm">/* Child */</span>
<a id="__codelineno-30-25" name="__codelineno-30-25"></a><span class="w">            </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-30-26" name="__codelineno-30-26"></a><span class="w">        </span><span class="cm">/* Parent */</span>
<a id="__codelineno-30-27" name="__codelineno-30-27"></a><span class="w">        </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-30-28" name="__codelineno-30-28"></a><span class="w">        </span><span class="n">Sigprocmask</span><span class="p">(</span><span class="n">SIG_SETMASK</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">prev</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><span class="w"> </span><span class="cm">/* Unblock SIGCHLD */</span>
<a id="__codelineno-30-29" name="__codelineno-30-29"></a><span class="w">        </span><span class="cm">/* Wait for SIGCHLD to be received (wasteful) */</span>
<a id="__codelineno-30-30" name="__codelineno-30-30"></a><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">pid</span><span class="p">)</span>
<a id="__codelineno-30-31" name="__codelineno-30-31"></a><span class="w">            </span><span class="p">;</span>
<a id="__codelineno-30-32" name="__codelineno-30-32"></a><span class="w">        </span><span class="cm">/* Do some work after receiving SIGCHLD */</span>
<a id="__codelineno-30-33" name="__codelineno-30-33"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">);</span>
<a id="__codelineno-30-34" name="__codelineno-30-34"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-30-35" name="__codelineno-30-35"></a><span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-30-36" name="__codelineno-30-36"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>çˆ¶è¿›ç¨‹å…ˆä¸ºä¿¡å· SIGCHLD å’Œ SIGINT å®‰è£…å¤„ç†ç¨‹åºï¼Œç„¶ååˆ›å»ºå­è¿›ç¨‹å¹¶å°†å…¨å±€å˜é‡<code>pid</code>è®¾ä¸º 0ï¼Œæœ€åè¿›å…¥è‡ªæ—‹å¾ªç¯ï¼ˆ<code>while (!pid)</code>ï¼‰ã€‚å­è¿›ç¨‹ç»ˆæ­¢åï¼Œ<code>pid</code>å˜ä¸ºé 0ï¼Œäºæ˜¯çˆ¶è¿›ç¨‹é€€å‡ºè‡ªæ—‹å¾ªç¯ã€‚ä¸ºäº†é˜²æ­¢çˆ¶è¿›ç¨‹è¿›å…¥è‡ªæ—‹å¾ªç¯å‰æ¥æ”¶åˆ° SIGCHLD ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åˆ›å»ºå­è¿›ç¨‹ä¹‹å‰é˜»å¡è¯¥ä¿¡å·ã€‚</p>
<p>è¿™æ®µä»£ç æ˜¯æ­£ç¡®çš„ï¼Œä½†è‡ªæ—‹å¾ªç¯ä¼šæµªè´¹å¤„ç†å™¨èµ„æºã€‚æˆ‘ä»¬å¯ä»¥å°†å…¶æ”¹ä¸ºï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span>
<span class="normal"><a href="#__codelineno-31-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">pid</span><span class="p">)</span><span class="w"> </span><span class="cm">/* Race! */</span>
<a id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="w">    </span><span class="n">pause</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
<p>é—®é¢˜åœ¨äºï¼šå¦‚æœçˆ¶è¿›ç¨‹åœ¨ While çš„æ¡ä»¶æµ‹è¯•ä¹‹åè€Œ<code>pause</code>çš„æ‰§è¡Œä¹‹å‰æ¥æ”¶åˆ° SIGCHLDï¼Œé‚£ä¹ˆç¨‹åºå°±ä¼šæ°¸è¿œä¼‘çœ ã€‚æˆ‘ä»¬è¿˜å¯ä»¥å°†<code>pause</code>æ”¹ä¸º<code>sleep</code>ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span>
<span class="normal"><a href="#__codelineno-32-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">pid</span><span class="p">)</span><span class="w"> </span><span class="cm">/* Too slow! */</span>
<a id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="w">    </span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>è¿™æ ·è™½ç„¶é¿å…äº†ç«äº‰é—®é¢˜ï¼Œä½†ä¼šå¢åŠ ç¨‹åºçš„è¿è¡Œæ—¶é—´ã€‚æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆæ˜¯è°ƒç”¨å‡½æ•°<code>sigsuspend</code>ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">1</a></span>
<span class="normal"><a href="#__codelineno-33-2">2</a></span>
<span class="normal"><a href="#__codelineno-33-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;signal.h&gt;</span>
<a id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="kt">int</span><span class="w"> </span><span class="nf">sigsuspend</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">sigset_t</span><span class="w"> </span><span class="o">*</span><span class="n">mask</span><span class="p">);</span>
<a id="__codelineno-33-3" name="__codelineno-33-3"></a><span class="c1">// Returns: -1</span>
</code></pre></div></td></tr></table></div>
<p>è¯¥å‡½æ•°ä½¿ç”¨å‚æ•°<code>mask</code>æ›¿æ¢å½“å‰çš„é˜»å¡ä¿¡å·é›†åˆï¼Œç„¶åæš‚åœè¿›ç¨‹ç›´è‡³å…¶æ¥æ”¶ä¿¡å·ã€‚å¦‚æœè¯¥ä¿¡å·çš„åŠ¨ä½œæ˜¯ç»ˆæ­¢è¿›ç¨‹ï¼Œåˆ™è¿›ç¨‹ç»ˆæ­¢ä¸”ä¸ä»<code>sigsuspend</code>è¿”å›ï¼›å¦‚æœè¯¥ä¿¡å·çš„åŠ¨ä½œæ˜¯è¿è¡Œä¸€ä¸ªå¤„ç†ç¨‹åºï¼Œåˆ™<code>sigsuspend</code>åœ¨å¤„ç†ç¨‹åºè¿”å›åè¿”å›ï¼Œå¹¶å°†é˜»å¡ä¿¡å·é›†åˆçš„çŠ¶æ€æ¢å¤ã€‚</p>
<p>å®é™…ä¸Šå®ƒç­‰æ•ˆäºä¸‹åˆ—å‡½æ•°ç»„åˆçš„åŸå­æ€§ï¼ˆAtomicï¼Œå³ä¸å¯ä¸­æ–­ï¼‰ç‰ˆæœ¬ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span>
<span class="normal"><a href="#__codelineno-34-2">2</a></span>
<span class="normal"><a href="#__codelineno-34-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="n">sigprocmask</span><span class="p">(</span><span class="n">SIG_SETMASK</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mask</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">prev</span><span class="p">);</span>
<a id="__codelineno-34-2" name="__codelineno-34-2"></a><span class="n">pause</span><span class="p">();</span>
<a id="__codelineno-34-3" name="__codelineno-34-3"></a><span class="n">sigprocmask</span><span class="p">(</span><span class="n">SIG_SETMASK</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">prev</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>å› æ­¤æˆ‘ä»¬å¯ä»¥å°†ç¤ºä¾‹å‡½æ•°ä¿®æ”¹ä¸ºï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-35-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-35-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-35-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-35-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-35-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-35-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-35-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-35-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-35-10">10</a></span>
<span class="normal"><a href="#__codelineno-35-11">11</a></span>
<span class="normal"><a href="#__codelineno-35-12">12</a></span>
<span class="normal"><a href="#__codelineno-35-13">13</a></span>
<span class="normal"><a href="#__codelineno-35-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="p">{</span>
<a id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="w">    </span><span class="n">Sigprocmask</span><span class="p">(</span><span class="n">SIG_BLOCK</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mask</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">prev</span><span class="p">);</span><span class="w"> </span><span class="cm">/* Block SIGCHLD */</span>
<a id="__codelineno-35-4" name="__codelineno-35-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Fork</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">                      </span><span class="cm">/* Child */</span>
<a id="__codelineno-35-5" name="__codelineno-35-5"></a><span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-35-6" name="__codelineno-35-6"></a><span class="w">    </span><span class="cm">/* Wait for SIGCHLD to be received */</span>
<a id="__codelineno-35-7" name="__codelineno-35-7"></a><span class="w">    </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-35-8" name="__codelineno-35-8"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">pid</span><span class="p">)</span>
<a id="__codelineno-35-9" name="__codelineno-35-9"></a><span class="w">        </span><span class="n">sigsuspend</span><span class="p">(</span><span class="o">&amp;</span><span class="n">prev</span><span class="p">);</span>
<a id="__codelineno-35-10" name="__codelineno-35-10"></a><span class="w">    </span><span class="cm">/* Optionally unblock SIGCHLD */</span>
<a id="__codelineno-35-11" name="__codelineno-35-11"></a><span class="w">    </span><span class="n">Sigprocmask</span><span class="p">(</span><span class="n">SIG_SETMASK</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">prev</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="__codelineno-35-12" name="__codelineno-35-12"></a><span class="w">    </span><span class="cm">/* Do some work after receiving SIGCHLD */</span>
<a id="__codelineno-35-13" name="__codelineno-35-13"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">);</span>
<a id="__codelineno-35-14" name="__codelineno-35-14"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h2 id="_36">éæœ¬åœ°è·³è½¬<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h2>
<p>C æä¾›äº†ä¸€ç§ç”¨æˆ·çº§åˆ«çš„å¼‚å¸¸æ§åˆ¶æµï¼Œå³éæœ¬åœ°è·³è½¬ï¼ˆNonlocal Jumpï¼‰ã€‚å®ƒæ— éœ€å®Œæˆæ­£å¸¸çš„è°ƒç”¨/è¿”å›åºåˆ—ï¼Œå°±å¯ä»¥å°†æ§åˆ¶æƒä»ä¸€ä¸ªå‡½æ•°ç›´æ¥è½¬ç§»åˆ°å¦ä¸€ä¸ªå½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°ã€‚éæœ¬åœ°è·³è½¬æ˜¯é€šè¿‡<code>setjmp</code>å’Œ<code>longjmp</code>å‡½æ•°å®ç°çš„ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span>
<span class="normal"><a href="#__codelineno-36-2">2</a></span>
<span class="normal"><a href="#__codelineno-36-3">3</a></span>
<span class="normal"><a href="#__codelineno-36-4">4</a></span>
<span class="normal"><a href="#__codelineno-36-5">5</a></span>
<span class="normal"><a href="#__codelineno-36-6">6</a></span>
<span class="normal"><a href="#__codelineno-36-7">7</a></span>
<span class="normal"><a href="#__codelineno-36-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;setjmp.h&gt;</span>
<a id="__codelineno-36-2" name="__codelineno-36-2"></a><span class="kt">int</span><span class="w"> </span><span class="nf">setjmp</span><span class="p">(</span><span class="kt">jmp_buf</span><span class="w"> </span><span class="n">env</span><span class="p">);</span>
<a id="__codelineno-36-3" name="__codelineno-36-3"></a><span class="kt">int</span><span class="w"> </span><span class="nf">sigsetjmp</span><span class="p">(</span><span class="n">sigjmp_buf</span><span class="w"> </span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">savesigs</span><span class="p">);</span>
<a id="__codelineno-36-4" name="__codelineno-36-4"></a><span class="c1">// Returns: 0 from setjmp, nonzero from longjmps</span>
<a id="__codelineno-36-5" name="__codelineno-36-5"></a>
<a id="__codelineno-36-6" name="__codelineno-36-6"></a><span class="kt">void</span><span class="w"> </span><span class="nf">longjmp</span><span class="p">(</span><span class="kt">jmp_buf</span><span class="w"> </span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">retval</span><span class="p">);</span>
<a id="__codelineno-36-7" name="__codelineno-36-7"></a><span class="kt">void</span><span class="w"> </span><span class="nf">siglongjmp</span><span class="p">(</span><span class="n">sigjmp_buf</span><span class="w"> </span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">retval</span><span class="p">);</span>
<a id="__codelineno-36-8" name="__codelineno-36-8"></a><span class="c1">// Never returns</span>
</code></pre></div></td></tr></table></div>
<p><code>setjmp</code>å‡½æ•°å°†å½“å‰è°ƒç”¨ç¯å¢ƒï¼ˆCalling Environmentï¼ŒåŒ…æ‹¬ç¨‹åºè®¡æ•°å™¨ã€æ ˆæŒ‡é’ˆå’Œé€šç”¨å¯„å­˜å™¨ç­‰ï¼‰ï¼Œä¿å­˜åœ¨å‚æ•°<code>env</code>æŒ‡å®šçš„ç¼“å†²åŒºä¸­å¹¶è¿”å› 0ã€‚<code>longjmp</code>å‡½æ•°ä¼šä»<code>env</code>ç¼“å†²åŒºæ¢å¤è°ƒç”¨ç¯å¢ƒï¼Œç„¶åè§¦å‘æœ€è¿‘è°ƒç”¨çš„<code>setjmp</code>å‡½æ•°çš„è¿”å›ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>setjmp</code>ä¼šè¿”å›ä¸€ä¸ªéé›¶å€¼<code>retval</code>ã€‚åœ¨ä¿¡å·å¤„ç†ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>sigsetjmp</code>å’Œ<code>siglongjmp</code>ä»£æ›¿å®ƒä»¬ã€‚</p>
<p>éå±€éƒ¨è·³è½¬çš„ä¸€ä¸ªé‡è¦åº”ç”¨æ˜¯å¯ä»¥åœ¨æ£€æµ‹åˆ°æŸäº›é”™è¯¯æ¡ä»¶æ—¶ï¼Œä»æ·±åº¦åµŒå¥—çš„å‡½æ•°è°ƒç”¨ä¸­ç«‹å³è¿”å›ã€‚æˆ‘ä»¬ä½¿ç”¨éæœ¬åœ°è·³è½¬ç›´æ¥è¿”å›åˆ°å¸¸è§çš„é”™è¯¯å¤„ç†ç¨‹åºï¼Œæ— éœ€è´¹åŠ›åœ°å±•å¼€æ ˆï¼ˆUnwind Stackï¼‰ã€‚</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-37-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-37-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-37-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-37-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-37-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-37-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-37-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-37-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-37-10">10</a></span>
<span class="normal"><a href="#__codelineno-37-11">11</a></span>
<span class="normal"><a href="#__codelineno-37-12">12</a></span>
<span class="normal"><a href="#__codelineno-37-13">13</a></span>
<span class="normal"><a href="#__codelineno-37-14">14</a></span>
<span class="normal"><a href="#__codelineno-37-15">15</a></span>
<span class="normal"><a href="#__codelineno-37-16">16</a></span>
<span class="normal"><a href="#__codelineno-37-17">17</a></span>
<span class="normal"><a href="#__codelineno-37-18">18</a></span>
<span class="normal"><a href="#__codelineno-37-19">19</a></span>
<span class="normal"><a href="#__codelineno-37-20">20</a></span>
<span class="normal"><a href="#__codelineno-37-21">21</a></span>
<span class="normal"><a href="#__codelineno-37-22">22</a></span>
<span class="normal"><a href="#__codelineno-37-23">23</a></span>
<span class="normal"><a href="#__codelineno-37-24">24</a></span>
<span class="normal"><a href="#__codelineno-37-25">25</a></span>
<span class="normal"><a href="#__codelineno-37-26">26</a></span>
<span class="normal"><a href="#__codelineno-37-27">27</a></span>
<span class="normal"><a href="#__codelineno-37-28">28</a></span>
<span class="normal"><a href="#__codelineno-37-29">29</a></span>
<span class="normal"><a href="#__codelineno-37-30">30</a></span>
<span class="normal"><a href="#__codelineno-37-31">31</a></span>
<span class="normal"><a href="#__codelineno-37-32">32</a></span>
<span class="normal"><a href="#__codelineno-37-33">33</a></span>
<span class="normal"><a href="#__codelineno-37-34">34</a></span>
<span class="normal"><a href="#__codelineno-37-35">35</a></span>
<span class="normal"><a href="#__codelineno-37-36">36</a></span>
<span class="normal"><a href="#__codelineno-37-37">37</a></span>
<span class="normal"><a href="#__codelineno-37-38">38</a></span>
<span class="normal"><a href="#__codelineno-37-39">39</a></span>
<span class="normal"><a href="#__codelineno-37-40">40</a></span>
<span class="normal"><a href="#__codelineno-37-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;csapp.h&quot;</span>
<a id="__codelineno-37-2" name="__codelineno-37-2"></a>
<a id="__codelineno-37-3" name="__codelineno-37-3"></a><span class="kt">jmp_buf</span><span class="w"> </span><span class="n">buf</span><span class="p">;</span>
<a id="__codelineno-37-4" name="__codelineno-37-4"></a>
<a id="__codelineno-37-5" name="__codelineno-37-5"></a><span class="kt">int</span><span class="w"> </span><span class="n">error1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-37-6" name="__codelineno-37-6"></a><span class="kt">int</span><span class="w"> </span><span class="n">error2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-37-7" name="__codelineno-37-7"></a>
<a id="__codelineno-37-8" name="__codelineno-37-8"></a><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="kt">void</span><span class="p">),</span><span class="w"> </span><span class="n">bar</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<a id="__codelineno-37-9" name="__codelineno-37-9"></a>
<a id="__codelineno-37-10" name="__codelineno-37-10"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<a id="__codelineno-37-11" name="__codelineno-37-11"></a><span class="p">{</span>
<a id="__codelineno-37-12" name="__codelineno-37-12"></a><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">setjmp</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span>
<a id="__codelineno-37-13" name="__codelineno-37-13"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-37-14" name="__codelineno-37-14"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-37-15" name="__codelineno-37-15"></a><span class="w">        </span><span class="n">foo</span><span class="p">();</span>
<a id="__codelineno-37-16" name="__codelineno-37-16"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
<a id="__codelineno-37-17" name="__codelineno-37-17"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-37-18" name="__codelineno-37-18"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Detected an error1 condition in foo</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<a id="__codelineno-37-19" name="__codelineno-37-19"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
<a id="__codelineno-37-20" name="__codelineno-37-20"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-37-21" name="__codelineno-37-21"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Detected an error2 condition in foo</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<a id="__codelineno-37-22" name="__codelineno-37-22"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
<a id="__codelineno-37-23" name="__codelineno-37-23"></a><span class="w">    </span><span class="k">default</span><span class="o">:</span>
<a id="__codelineno-37-24" name="__codelineno-37-24"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unknown error condition in foo</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<a id="__codelineno-37-25" name="__codelineno-37-25"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-37-26" name="__codelineno-37-26"></a><span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-37-27" name="__codelineno-37-27"></a><span class="p">}</span>
<a id="__codelineno-37-28" name="__codelineno-37-28"></a>
<a id="__codelineno-37-29" name="__codelineno-37-29"></a><span class="cm">/* Deeply nested function foo */</span>
<a id="__codelineno-37-30" name="__codelineno-37-30"></a><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<a id="__codelineno-37-31" name="__codelineno-37-31"></a><span class="p">{</span>
<a id="__codelineno-37-32" name="__codelineno-37-32"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error1</span><span class="p">)</span>
<a id="__codelineno-37-33" name="__codelineno-37-33"></a><span class="w">        </span><span class="n">longjmp</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-37-34" name="__codelineno-37-34"></a><span class="w">    </span><span class="n">bar</span><span class="p">();</span>
<a id="__codelineno-37-35" name="__codelineno-37-35"></a><span class="p">}</span>
<a id="__codelineno-37-36" name="__codelineno-37-36"></a>
<a id="__codelineno-37-37" name="__codelineno-37-37"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bar</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<a id="__codelineno-37-38" name="__codelineno-37-38"></a><span class="p">{</span>
<a id="__codelineno-37-39" name="__codelineno-37-39"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error2</span><span class="p">)</span>
<a id="__codelineno-37-40" name="__codelineno-37-40"></a><span class="w">        </span><span class="n">longjmp</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<a id="__codelineno-37-41" name="__codelineno-37-41"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>ç¤ºä¾‹ç¨‹åºä¸­ä¸»å‡½æ•°é¦–å…ˆè°ƒç”¨<code>setjmp</code>ä¿å­˜å½“å‰è°ƒç”¨ç¯å¢ƒï¼Œç„¶åä¾æ¬¡è°ƒç”¨å‡½æ•°<code>foo</code>å’Œ<code>bar</code>ã€‚ ä¸€æ—¦å‡½æ•°æ‰§è¡Œå‘ç”Ÿé”™è¯¯ï¼Œå®ƒä»¬ä¼šç«‹å³é€šè¿‡<code>longjmp</code>ä»<code>setjmp</code>è¿”å›ã€‚<code>setjmp</code>çš„éé›¶è¿”å›å€¼è¡¨ç¤ºé”™è¯¯çš„ç±»å‹ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­çš„æŸå¤„å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚</p>
<p>éå±€éƒ¨è·³è½¬çš„å¦ä¸€ä¸ªé‡è¦åº”ç”¨æ˜¯ä»ä¿¡å·å¤„ç†ç¨‹åºè·³è½¬åˆ°ç‰¹å®šä»£ç ä½ç½®ï¼Œè€Œä¸æ˜¯åƒå¾€å¸¸é‚£æ ·è¿”å›åˆ°å› ä¿¡å·ä¸­æ–­çš„æŒ‡ä»¤ã€‚</p>
<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Render date of last update -->


<!-- Render date of creation -->


<!-- ---------------------------------------------------------------------- -->

<!-- Render authors -->


<!-- ---------------------------------------------------------------------- -->

<!-- Render committers from GitHub -->


<!-- Render committers from GitLab -->


<!-- Render committers -->


<!-- ---------------------------------------------------------------------- -->

<!-- Determine date of last update -->

  
    
  

  <!-- Determine date of creation -->
  
    
  


<!-- Source file information -->

  <aside class="md-source-file">

    <!-- Date of last update -->
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="æœ€åæ›´æ–°">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-08-09</span>
  </span>

    

    <!-- Date of creation -->
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="åˆ›å»ºæ—¥æœŸ">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-08-09</span>
  </span>

    

    <!-- Authors (git-authors plugin) -->
    

    <!-- Authors (git-committers plugin) -->
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="è´¡çŒ®è€…">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a
          href="https://github.com/tang-jiapeng"
          class="md-author"
          title="@tang-jiapeng"
        >
          
          <img
            src="https://avatars.githubusercontent.com/u/83797617?v=4&size=72"
            alt="tang-jiapeng"
          />
        </a>
      

      <!-- More authors -->
      
      
    </nav>
  </span>

    
  </aside>

<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine feedback configuration -->

  


<!-- Determine whether to show feedback -->


<!-- Was this page helpful? -->

<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Comment system -->





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  å›åˆ°é¡µé¢é¡¶éƒ¨
</button>
        
      </main>
      
        <!-- Footer -->
<footer class="md-footer">

  <!-- Link to previous and/or next page -->
  
    
      
      <nav
        class="md-footer__inner md-grid"
        aria-label="é¡µè„š"
        
      >

        <!-- Link to previous page -->
        
          
          <a
            href="../ch7/"
            class="md-footer__link md-footer__link--prev"
            aria-label="ä¸Šä¸€é¡µ: Chapter7ï¼šé“¾æ¥"
          >
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                ä¸Šä¸€é¡µ
              </span>
              <div class="md-ellipsis">
                Chapter7ï¼šé“¾æ¥
              </div>
            </div>
            
          </a>
        

        <!-- Link to next page -->
        
          
          <a
            href="../ch9/"
            class="md-footer__link md-footer__link--next"
            aria-label="ä¸‹ä¸€é¡µ: Chapter9ï¼šè™šæ‹Ÿå†…å­˜"
          >
            <div class="md-footer__title">
              <span class="md-footer__direction">
                ä¸‹ä¸€é¡µ
              </span>
              <div class="md-ellipsis">
                Chapter9ï¼šè™šæ‹Ÿå†…å­˜
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  

  <!-- Further information -->
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022~2024 0X10CC/All Rights Reserved.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
   
    <font color="#B9B9B9">
      <div class="footer-visit-count" style="display: flex; justify-content: center; align-items: center;">
    æœ¬ç«™è®¿é—®é‡ï¼š<script async src="//finicounter.eu.org/finicounter.js"></script>
    <span id="finicount_views"></span>    &nbsp;|&nbsp;
    <footer>
      <a href="https://icp.gov.moe/?keyword=20249950" target="_blank">èŒICPå¤‡20249950å·</a>
    </footer>
  </div>
      </font>

      <style>
        .footer-visit-count {
            height: fit-content;
            min-height: 55px; /* æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´æ­¤é«˜åº¦ */
        }
        </style>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/tang-jiapeng" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<tangjiapeng0215@gmail.com>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 112c-8.8 0-16 7.2-16 16v22.1l172.5 141.6c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16zM48 212.2V384c0 8.8 7.2 16 16 16h384c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0zM0 128c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "search.share", "navigation.expand", "navigation.indexes", "content.tabs.link", "content.tooltips", "content.code.copy", "content.action.edit", "content.action.view", "content.code.annotate", "toc.follow"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
     -->
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/javascripts/extra.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.0.2/dist/add-html-label-6e56ed67.min.js"></script>
      
    
    <script src="../../../assets/javascripts/custom.9458f965.min.js"></script>
  
  </body>
</html>